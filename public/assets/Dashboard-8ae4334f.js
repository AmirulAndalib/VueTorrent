import{e as L,a1 as c,a5 as w,aa as p,X as m,V as I,c as D,a2 as C,a3 as a,F as W,a6 as ae,u as i,k as t,R as Ze,m as R,a4 as He,ad as et,a7 as O,ae as ze,af as qe,_ as Ce,b as E,r as Ge,L as me,x as je,W as H,an as ue,B as te,$ as Ye,ao as tt,ap as at,a0 as Me,j as ot,q as lt,aq as nt,A as Re,M as Te,O as Ve}from"./vue-dd277fb2.js";import{V as Ne,_ as De,u as oe,f as st,a as it,T as A,b as rt,c as dt,d as ut,e as ct,g as ce,h as Xe,i as pe,j as z,k as Be,D as U,l as $e,m as ve,n as We,o as Ie,p as ee,q as Le,r as J,s as Ee,t as q,v as Pe,w as P,x as Ae,y as mt,z as we,A as Se,B as de,C as xe,E as Je,F as pt,G as K,H as Qe,I as Fe,J as vt,K as ht,L as Oe}from"./index-e06e1d7f.js";import{_ as _t}from"./MoveTorrentDialog.vue_vue_type_script_setup_true_lang-e5404916.js";import{d as Ue}from"./dayjs.min-444eeb73.js";import"./faker-dcfab09f.js";import{u as ft}from"./ArrayPagination-f0ef450c.js";import{d as bt}from"./index-cc3a7171.js";import{ac as gt}from"./vuetify-c999d958.js";const yt={class:"d-flex flex-column"},kt={class:"text-caption text-grey"},Tt={class:"text-caption text-grey"},Vt=L({__name:"ItemAmount",props:{torrent:{},title:{},value:{},total:{}},setup(V){return(e,l)=>(c(),w("div",yt,[p("div",kt,m(e.$t(`torrent.properties.${e.title}`)),1),p("div",null,[I(m(e.torrent[e.value])+" ",1),p("span",Tt," / "+m(e.torrent[e.total]),1)])]))}}),$t={class:"d-flex flex-column"},wt={class:"text-caption text-grey"},xt={class:"d-flex flex-row gap"},Bt=L({__name:"ItemChip",props:{torrent:{},title:{},value:{},color:{}},setup(V){const e=V,l=D(()=>{const r=e.torrent[e.value],n=typeof r;if(n==="string")return r.length>0?[r]:[];if(n==="object")return r});return(r,n)=>(c(),w("div",$t,[p("div",wt,m(r.$t(`torrent.properties.${r.title}`)),1),p("div",xt,[!l.value||l.value.length<1?(c(),C(Ne,{key:0,color:r.color.replace("$1",r.torrent[r.value]),variant:"flat"},{default:a(()=>[I(m(r.$t(`torrent.properties.empty_${r.value}`)),1)]),_:1},8,["color"])):(c(!0),w(W,{key:1},ae(l.value,f=>(c(),C(Ne,{color:r.color.replace("$1",r.torrent.state),variant:"flat"},{default:a(()=>[I(m(f),1)]),_:2},1032,["color"]))),256))])]))}});const St=De(Bt,[["__scopeId","data-v-8eb4906a"]]),Ct={class:"d-flex flex-column"},Dt={class:"text-caption text-grey"},It={class:"text-caption text-grey"},Lt=L({__name:"ItemData",props:{torrent:{},title:{},value:{}},setup(V){const e=oe();return(l,r)=>(c(),w("div",Ct,[p("div",Dt,m(l.$t(`torrent.properties.${l.title}`)),1),p("div",null,[I(m(i(st)(l.torrent[l.value],i(e).useBinarySize))+" ",1),p("span",It,m(i(it)(l.torrent[l.value],i(e).useBinarySize)),1)])]))}}),Et={class:"d-flex flex-column"},Pt={class:"text-caption text-grey"},At={key:0},Ut={key:1},Mt=L({__name:"ItemDateTime",props:{torrent:{},title:{},value:{}},setup(V){const e=oe();return(l,r)=>(c(),w("div",Et,[p("div",Pt,m(l.$t(`torrent.properties.${l.title}`)),1),p("div",null,[l.torrent[l.value]>0?(c(),w("span",At,m(i(Ue)(l.torrent[l.value]*1e3).format(i(e).dateFormat??"DD/MM/YYYY, HH:mm:ss")),1)):(c(),w("span",Ut,m(l.$t("dashboard.not_complete")),1))])]))}}),Rt={class:"d-flex flex-column"},Nt={class:"text-caption text-grey"},Ft={key:0},Ot={key:1},Kt="D[d] H[h] m[m] s[s]",Ht=L({__name:"ItemDuration",props:{torrent:{},title:{},value:{}},setup(V){return(e,l)=>(c(),w("div",Rt,[p("div",Nt,m(e.$t(`torrent.properties.${e.title}`)),1),p("div",null,[e.torrent[e.value]>0?(c(),w("span",Ft,m(i(Ue).duration(e.torrent[e.value],"seconds").format(Kt)),1)):(c(),w("span",Ot,m(e.$t("dashboard.not_complete")),1))])]))}}),zt={class:"d-flex flex-column"},qt={class:"text-caption text-grey"},Gt=L({__name:"ItemPercent",props:{torrent:{},title:{},value:{}},setup(V){const e=V,l=D(()=>[A.UPLOADING,A.CHECKING_UP,A.FORCED_UP,A.ALLOCATING,A.DOWNLOADING,A.META_DL,A.CHECKING_DL,A.FORCED_DL,A.CHECKING_RESUME_DATA,A.MOVING].includes(e.torrent.state));return(r,n)=>(c(),w("div",zt,[p("div",qt,m(r.$t(`torrent.properties.${r.title}`)),1),t(dt,{"model-value":r.torrent[r.value],max:1,striped:l.value,height:20,color:`torrent-${r.torrent.state}`,rounded:"sm",style:{width:"10em"}},{default:a(()=>[I(m(i(rt)(r.torrent[r.value])),1)]),_:1},8,["model-value","striped","color"])]))}}),jt={class:"d-flex flex-column"},Yt={class:"text-caption text-grey"},Xt=L({__name:"ItemRelativeTime",props:{torrent:{},title:{},value:{}},setup(V){return(e,l)=>(c(),w("div",jt,[p("div",Yt,m(e.$t(`torrent.properties.${e.title}`)),1),p("div",null,[p("span",null,m(i(Ue)(e.torrent[e.value]*1e3).fromNow()),1)])]))}}),Wt={class:"d-flex flex-column"},Jt={class:"text-caption text-grey"},Qt={class:"text-caption text-grey"},Zt=L({__name:"ItemSpeed",props:{torrent:{},title:{},value:{}},setup(V){const e=oe();return(l,r)=>(c(),w("div",Wt,[p("div",Jt,m(l.$t(`torrent.properties.${l.title}`)),1),p("div",null,[I(m(i(ut)(l.torrent[l.value],i(e).useBitSpeed))+" ",1),p("span",Qt,m(i(ct)(l.torrent[l.value],i(e).useBitSpeed)),1)])]))}}),ea={class:"d-flex flex-column"},ta={class:"text-caption text-grey"},aa=L({__name:"ItemText",props:{torrent:{},title:{},value:{}},setup(V){return(e,l)=>(c(),w("div",ea,[p("div",ta,m(e.$t(`torrent.properties.${e.title}`)),1),p("div",null,m(e.torrent[e.value]),1)]))}}),oa={class:"d-flex gap flex-wrap"},la=L({__name:"Torrent",props:{torrent:{}},setup(V){const e=V,l=ce(),r=oe(),n=D(()=>(e.torrent.progress===1?r.doneTorrentProperties:r.busyTorrentProperties).filter(h=>h.active).sort((h,k)=>h.order-k.order));function f(o){o.shiftKey?l.spanTorrentSelection(e.torrent.hash):(Be(o)||l.isSelectionMultiple)&&(l.isSelectionMultiple=!0,l.toggleSelect(e.torrent.hash))}const g=o=>{switch(o){case U.AMOUNT:return Vt;case U.CHIP:return St;case U.DATA:return Lt;case U.DATETIME:return Mt;case U.DURATION:return Ht;case U.PERCENT:return Gt;case U.RELATIVE:return Xt;case U.SPEED:return Zt;case U.TEXT:default:return aa}},y=D(()=>l.isTorrentInSelection(e.torrent.hash));return(o,h)=>(c(),C(z,{class:He(`sideborder ${o.torrent.state} pointer`),color:y.value?`torrent-${o.torrent.state}-darken-3`:void 0,width:"100%",onClick:f},{default:a(()=>[t(Xe,{class:"text-wrap text-subtitle-1 pt-1 pb-0"},{default:a(()=>[I(m(o.torrent.name),1)]),_:1}),t(pe,{class:"pa-2 pt-0"},{default:a(()=>[p("div",oa,[(c(!0),w(W,null,ae(n.value,k=>(c(),C(Ze(g(k.type)),R({torrent:o.torrent},k.props),null,16,["torrent"]))),256))])]),_:1})]),_:1},8,["class","color"]))}});const na=De(la,[["__scopeId","data-v-6b29cb94"]]),sa={class:"d-flex"},ia={key:2},ra={key:3},da=L({__name:"RightClickMenuEntry",props:{text:{},icon:{},action:{type:Function},hidden:{type:Boolean},disabled:{type:Boolean},disabledText:{},disabledIcon:{},divider:{type:Boolean},children:{}},setup(V){return(e,l)=>{const r=et("RightClickMenuEntry",!0);return e.hidden?O("",!0):(c(),C(ee,{key:0,class:"px-3 pointer",disabled:e.disabled,onClick:e.action},{default:a(()=>[p("div",sa,[e.disabled&&e.disabledIcon?(c(),C($e,{key:0,class:"mr-2"},{default:a(()=>[I(m(e.disabledIcon),1)]),_:1})):e.icon?(c(),C($e,{key:1,class:"mr-2"},{default:a(()=>[I(m(e.icon),1)]),_:1})):O("",!0),e.disabled&&e.disabledText?(c(),w("span",ia,m(e.disabledText),1)):(c(),w("span",ra,m(e.text),1)),t(ve),!e.disabled&&e.children?(c(),C($e,{key:4},{default:a(()=>[I("mdi-chevron-right")]),_:1})):O("",!0)]),e.children?(c(),C(We,{key:0,activator:"parent","open-on-hover":!0,"open-on-click":!0,"close-delay":"0","open-delay":"0",location:"right"},{default:a(()=>[t(Ie,null,{default:a(()=>[(c(!0),w(W,null,ae(e.children,n=>(c(),C(r,ze(qe(n)),null,16))),256))]),_:1})]),_:1})):O("",!0)]),_:1},8,["disabled","onClick"]))}}}),ua=L({__name:"RenameTorrentDialog",props:{guid:{},hash:{}},setup(V){const e=V,{isOpened:l}=Le(e.guid),{t:r}=Ce(),n=J(),f=E(),g=E(),y=E(!1),o=Ge({newName:""}),h=[$=>!!$||r("dialogs.renameTorrent.required"),$=>$!==B.value||r("dialogs.renameTorrent.sameName")],k=D(()=>n.getTorrentByHash(e.hash)),B=D(()=>k.value?.name);async function _(){await g.value?.validate(),y.value&&(await n.renameTorrent(e.hash,o.newName),S())}const S=()=>{l.value=!1};return me(()=>{o.newName=k.value?.name||""}),je(()=>{f.value?.select()}),($,b)=>(c(),C(Ae,{modelValue:i(l),"onUpdate:modelValue":b[3]||(b[3]=d=>te(l)?l.value=d:null)},{default:a(()=>[t(z,null,{default:a(()=>[t(Xe,null,{default:a(()=>[I(m($.$t("dialogs.renameTorrent.title")),1)]),_:1}),t(pe,null,{default:a(()=>[t(i(Ee),{modelValue:y.value,"onUpdate:modelValue":b[1]||(b[1]=d=>y.value=d),ref_key:"form",ref:g,onSubmit:b[2]||(b[2]=H(()=>{},["prevent"]))},{default:a(()=>[B.value?(c(),C(q,{key:0,"model-value":B.value,disabled:"",label:$.$t("dialogs.renameTorrent.oldName")},null,8,["model-value","label"])):O("",!0),t(q,{modelValue:o.newName,"onUpdate:modelValue":b[0]||(b[0]=d=>o.newName=d),ref_key:"field",ref:f,rules:h,autofocus:"",label:$.$t("dialogs.renameTorrent.newName"),onKeydown:ue(_,["enter"])},null,8,["modelValue","label","onKeydown"])]),_:1},8,["modelValue"])]),_:1}),t(Pe,null,{default:a(()=>[t(ve),t(P,{color:"error",onClick:S},{default:a(()=>[I(m($.$t("common.cancel")),1)]),_:1}),t(P,{color:"accent",disabled:!y.value,onClick:_},{default:a(()=>[I(m($.$t("common.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),X=-2,M=-1,ca=L({__name:"ShareLimitDialog",props:{guid:{},hash:{}},setup(V){const e=V,{isOpened:l}=Le(e.guid),r=J(),n=E(!1),f=E("global"),g=E(!1),y=E(0),o=E(!1),h=E(0),k=E(!1),B=E(0),_=D(()=>f.value!=="enabled");function S(){l.value=!1}async function $(){switch(f.value){case"global":await r.setShareLimit([e.hash],X,X,X);break;case"disabled":await r.setShareLimit([e.hash],M,M,M);break;case"enabled":await r.setShareLimit([e.hash],g.value?y.value:M,o.value?h.value:M,k.value?B.value:M);break}S()}return me(async()=>{const b=r.getTorrentByHash(e.hash);if(!b)return S();const d=b.ratio_limit,T=b.seeding_time_limit,N=b.inactive_seeding_time_limit;d===X&&T===X&&N===X?f.value="global":d===M&&T===M&&N===M?f.value="disabled":(f.value="enabled",g.value=d>=0,y.value=g.value?d:0,o.value=T>=0,h.value=o.value?T:0,k.value=N>=0,B.value=k.value?N:0)}),(b,d)=>(c(),C(Ae,{modelValue:i(l),"onUpdate:modelValue":d[9]||(d[9]=T=>te(l)?l.value=T:null),"max-width":"500"},{default:a(()=>[t(z,{title:b.$t("dialogs.share_limit.title")},{default:a(()=>[t(pe,null,{default:a(()=>[t(Ee,{modelValue:n.value,"onUpdate:modelValue":d[7]||(d[7]=T=>n.value=T),onSubmit:d[8]||(d[8]=H(()=>{},["prevent"])),onKeydown:ue(H($,["prevent"]),["enter"])},{default:a(()=>[t(mt,{modelValue:f.value,"onUpdate:modelValue":d[0]||(d[0]=T=>f.value=T)},{default:a(()=>[t(we,{label:b.$t("dialogs.share_limit.global"),value:"global"},null,8,["label"]),t(we,{label:b.$t("dialogs.share_limit.disabled"),value:"disabled"},null,8,["label"]),t(we,{label:b.$t("dialogs.share_limit.enabled"),value:"enabled"},null,8,["label"])]),_:1},8,["modelValue"]),t(Se,null,{default:a(()=>[t(de,{cols:"12",class:"d-flex align-center"},{default:a(()=>[p("span",null,[t(xe,{modelValue:g.value,"onUpdate:modelValue":d[1]||(d[1]=T=>g.value=T),disabled:_.value},null,8,["modelValue","disabled"])]),t(q,{modelValue:y.value,"onUpdate:modelValue":d[2]||(d[2]=T=>y.value=T),disabled:_.value||!g.value,density:"compact","hide-details":"",label:b.$t("dialogs.share_limit.ratio_limit")},null,8,["modelValue","disabled","label"])]),_:1}),t(de,{cols:"12",class:"d-flex align-center"},{default:a(()=>[p("span",null,[t(xe,{modelValue:o.value,"onUpdate:modelValue":d[3]||(d[3]=T=>o.value=T),disabled:_.value},null,8,["modelValue","disabled"])]),t(q,{modelValue:h.value,"onUpdate:modelValue":d[4]||(d[4]=T=>h.value=T),disabled:_.value||!o.value,density:"compact","hide-details":"",label:b.$t("dialogs.share_limit.seeding_time_limit")},null,8,["modelValue","disabled","label"])]),_:1}),t(de,{cols:"12",class:"d-flex align-center"},{default:a(()=>[p("span",null,[t(xe,{modelValue:k.value,"onUpdate:modelValue":d[5]||(d[5]=T=>k.value=T),disabled:_.value},null,8,["modelValue","disabled"])]),t(q,{modelValue:B.value,"onUpdate:modelValue":d[6]||(d[6]=T=>B.value=T),disabled:_.value||!k.value,density:"compact","hide-details":"",label:b.$t("dialogs.share_limit.inactive_seeding_time_limit")},null,8,["modelValue","disabled","label"])]),_:1})]),_:1})]),_:1},8,["modelValue","onKeydown"])]),_:1}),t(Pe,null,{default:a(()=>[t(ve),t(P,{color:"error",onClick:S},{default:a(()=>[I(m(b.$t("common.cancel")),1)]),_:1}),t(P,{color:"accent",disabled:!n.value,onClick:$},{default:a(()=>[I(m(b.$t("common.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"]))}}),Ke=L({__name:"SpeedLimitDialog",props:{guid:{},hash:{},mode:{}},setup(V){const e=V,{isOpened:l}=Le(e.guid),r=J(),n=E(!1),f=E(0);function g(){l.value=!1}async function y(){const o=Math.max(0,f.value)*1e3;switch(e.mode){case"download":await r.setDownloadLimit(o,[e.hash]);break;case"upload":await r.setUploadLimit(o,[e.hash]);break}g()}return me(async()=>{const o=r.getTorrentByHash(e.hash);if(!o)return g();switch(e.mode){case"download":f.value=Math.max(0,Math.round(o.dl_limit/1e3));break;case"upload":f.value=Math.max(0,Math.round(o.up_limit/1e3));break}}),(o,h)=>(c(),C(Ae,{modelValue:i(l),"onUpdate:modelValue":h[3]||(h[3]=k=>te(l)?l.value=k:null)},{default:a(()=>[t(z,{title:o.$t(`dialogs.speed_limit.${o.mode}`)},{default:a(()=>[t(pe,null,{default:a(()=>[t(Ee,{modelValue:n.value,"onUpdate:modelValue":h[1]||(h[1]=k=>n.value=k),onSubmit:h[2]||(h[2]=H(()=>{},["prevent"])),onKeydown:ue(H(y,["prevent"]),["enter"])},{default:a(()=>[t(q,{modelValue:f.value,"onUpdate:modelValue":h[0]||(h[0]=k=>f.value=k),type:"number",autofocus:"",clearable:"",label:o.$t("dialogs.speed_limit.label"),"prepend-inner-icon":"mdi-speedometer",suffix:"kB/s",onKeydown:ue(H(y,["prevent"]),["enter"])},null,8,["modelValue","label","onKeydown"])]),_:1},8,["modelValue","onKeydown"])]),_:1}),t(Pe,null,{default:a(()=>[t(ve),t(P,{color:"error",onClick:g},{default:a(()=>[I(m(o.$t("common.cancel")),1)]),_:1}),t(P,{color:"accent",disabled:!n.value,onClick:y},{default:a(()=>[I(m(o.$t("common.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"]))}}),he=V=>(tt("data-v-18d5c938"),V=V(),at(),V),ma={class:"d-flex justify-space-around"},pa=he(()=>p("span",null,"Resume",-1)),va=he(()=>p("span",null,"Force Resume",-1)),ha=he(()=>p("span",null,"Pause",-1)),_a=he(()=>p("span",null,"Delete",-1)),fa=L({__name:"RightClickMenu",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup(V,{emit:e}){const l=V,r=e,{t:n}=Ce(),f=Ye(),g=ce(),y=Je(),o=J(),h=pt(),k=D({get:()=>l.modelValue,set:s=>r("update:modelValue",s)}),B=D(()=>g.selectedTorrents.length>1),_=D(()=>g.selectedTorrents),S=D(()=>_.value[0]),$=D(()=>o.getTorrentByHash(S.value)),b=D(()=>g.selectedTorrents.map(o.getTorrentByHash).filter(s=>!!s)),d=D(()=>[{name:""},...o.categories]);async function T(){await o.resumeTorrents(_)}async function N(){await o.forceResumeTorrents(_)}async function F(){await o.pauseTorrents(_)}function le(){y.createDialog(Qe,{hashes:[...g.selectedTorrents]})}function _e(){y.createDialog(_t,{hashes:[...g.selectedTorrents]})}function ne(){y.createDialog(ua,{hash:g.selectedTorrents[0]})}async function G(){await o.recheckTorrents(_)}async function fe(){await o.reannounceTorrents(_)}async function be(){await o.toggleSeqDl(_)}async function ge(){await o.toggleFLPiecePrio(_)}async function Q(){await o.toggleAutoTmm(_,!$.value?.auto_tmm)}function se(s){return b.value.every(u=>u&&u.tags&&u.tags.includes(s))}async function ye(s){se(s)?await o.removeTorrentTags(_.value,[s]):await o.addTorrentTags(_.value,[s])}async function j(s){await navigator.clipboard.writeText(s)}function ie(){y.createDialog(Ke,{hash:S.value,mode:"download"})}function re(){y.createDialog(Ke,{hash:S.value,mode:"upload"})}function ke(){y.createDialog(ca,{hash:S.value})}async function Z(){_.value.forEach(s=>{o.exportTorrent(s).then(u=>{const x=window.URL.createObjectURL(u),Y=document.createElement("a");Y.href=x,Y.style.opacity="0",Y.setAttribute("download",`${s}.torrent`),document.body.appendChild(Y),Y.click(),document.body.removeChild(Y)})})}const v=D(()=>[{text:n("dashboard.right_click.advanced.title"),icon:"mdi-head-cog",children:[{text:n("dashboard.right_click.advanced.change_location"),icon:"mdi-folder",action:_e},{text:n("dashboard.right_click.advanced.rename"),icon:"mdi-rename-box",hidden:B.value,action:ne},{text:n("dashboard.right_click.advanced.recheck"),icon:"mdi-playlist-check",action:G},{text:n("dashboard.right_click.advanced.reannounce"),icon:"mdi-bullhorn",action:fe},{text:n("dashboard.right_click.advanced.seq_dl"),icon:$.value?.seq_dl?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",action:be},{text:n("dashboard.right_click.advanced.f_l_prio"),icon:$.value?.f_l_piece_prio?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",action:ge},{text:n("dashboard.right_click.advanced.auto_tmm"),icon:$.value?.auto_tmm?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",action:Q}]},{text:n("dashboard.right_click.priority.title"),icon:"mdi-priority-high",hidden:!h.preferences.queueing_enabled,children:[{text:n("dashboard.right_click.priority.top"),icon:"mdi-priority-high",action:async()=>await o.setTorrentPriority(_.value,"topPrio")},{text:n("dashboard.right_click.priority.increase"),icon:"mdi-arrow-up",action:async()=>await o.setTorrentPriority(_.value,"increasePrio")},{text:n("dashboard.right_click.priority.decrease"),icon:"mdi-arrow-down",action:async()=>await o.setTorrentPriority(_.value,"decreasePrio")},{text:n("dashboard.right_click.priority.bottom"),icon:"mdi-priority-low",action:async()=>await o.setTorrentPriority(_.value,"bottomPrio")}]},{text:n("dashboard.right_click.tags.title"),icon:"mdi-tag",disabled:o.tags.length===0,disabledText:n("dashboard.right_click.tags.disabled_title"),disabledIcon:"mdi-tag-off",children:o.tags.map(s=>({text:s,icon:se(s)?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",action:async()=>await ye(s)}))},{text:n("dashboard.right_click.category.title"),icon:"mdi-label",disabled:o.categories.length===0,disabledText:n("dashboard.right_click.category.disabled_title"),disabledIcon:"mdi-label-off",children:d.value.map(s=>({text:s.name===""?n("dashboard.right_click.category.clear"):s.name,action:async()=>await o.setTorrentCategory(_.value,s.name)}))},{text:n("dashboard.right_click.speed_limit.title"),icon:"mdi-speedometer-slow",children:[{text:n("dashboard.right_click.speed_limit.download"),icon:"mdi-download",action:ie},{text:n("dashboard.right_click.speed_limit.upload"),icon:"mdi-upload",action:re},{text:n("dashboard.right_click.speed_limit.share"),icon:"mdi-account-group",action:ke}]},{text:n("dashboard.right_click.copy.title"),icon:"mdi-content-copy",hidden:B.value,children:[{text:n("dashboard.right_click.copy.name"),icon:"mdi-alphabetical-variant",action:async()=>$.value&&await j($.value.name)},{text:n("dashboard.right_click.copy.hash"),icon:"mdi-pound",action:async()=>await j(S.value)},{text:n("dashboard.right_click.copy.magnet"),icon:"mdi-magnet",action:async()=>$.value&&await j($.value.magnet)}]},{text:n("dashboard.right_click.export",g.selectedTorrents.length),icon:B.value?"mdi-download-multiple":"mdi-download",action:Z},{text:n("dashboard.right_click.info"),icon:"mdi-information",hidden:B.value,action:()=>f.push({name:"torrentDetail",params:{hash:S.value}})}]);return(s,u)=>k.value?(c(),C(We,{key:0,modelValue:k.value,"onUpdate:modelValue":u[0]||(u[0]=x=>k.value=x),activator:"parent","close-on-content-click":!0,transition:"slide-y-transition","scroll-strategy":"none"},{default:a(()=>[t(Ie,null,{default:a(()=>[t(ee,null,{default:a(()=>[p("div",ma,[t(K,{location:"top"},{activator:a(({props:x})=>[t(P,R({density:"compact",variant:"plain",icon:"mdi-play"},x,{onClick:T}),null,16)]),default:a(()=>[pa]),_:1}),t(K,{location:"top"},{activator:a(({props:x})=>[t(P,R({density:"compact",variant:"plain",icon:"mdi-fast-forward"},x,{onClick:N}),null,16)]),default:a(()=>[va]),_:1}),t(K,{location:"top"},{activator:a(({props:x})=>[t(P,R({density:"compact",variant:"plain",icon:"mdi-pause"},x,{onClick:F}),null,16)]),default:a(()=>[ha]),_:1}),t(K,{location:"top"},{activator:a(({props:x})=>[t(P,R({color:"red",density:"compact",variant:"plain",icon:"mdi-delete-forever"},x,{onClick:le}),null,16)]),default:a(()=>[_a]),_:1})])]),_:1}),(c(!0),w(W,null,ae(v.value,x=>(c(),C(da,ze(qe(x)),null,16))),256))]),_:1})]),_:1},8,["modelValue"])):O("",!0)}});const ba=De(fa,[["__scopeId","data-v-18d5c938"]]),ga={class:"pt-4 px-1 px-sm-5"},ya={class:"pa-0",style:{width:"10em"}},ka={class:"text-uppercase",style:{float:"right","font-size":"0.8em"}},Ta={class:"text-grey"},Va={key:0,class:"mt-5 text-xs-center"},$a={class:"text-grey"},wa={key:1},xa={class:"d-flex align-center"},Aa=L({__name:"Dashboard",setup(V){const{t:e}=Ce(),l=Ye(),r=gt(),{currentPage:n,isSelectionMultiple:f,selectedTorrents:g,sortOptions:y,torrentCountString:o}=Me(ce()),h=ce(),k=Je(),{filteredTorrents:B}=Me(J()),_=J(),S=oe(),$=[{value:"added_on",title:e("dashboard.sortBy.added_on")},{value:"amount_left",title:e("dashboard.sortBy.amount_left")},{value:"auto_tmm",title:e("dashboard.sortBy.auto_tmm")},{value:"availability",title:e("dashboard.sortBy.availability")},{value:"avg_download_speed",title:e("dashboard.sortBy.avg_download_speed")},{value:"avg_upload_speed",title:e("dashboard.sortBy.avg_upload_speed")},{value:"category",title:e("dashboard.sortBy.category")},{value:"completed",title:e("dashboard.sortBy.completed")},{value:"completion_on",title:e("dashboard.sortBy.completion_on")},{value:"content_path",title:e("dashboard.sortBy.content_path")},{value:"dl_limit",title:e("dashboard.sortBy.dl_limit")},{value:"dlspeed",title:e("dashboard.sortBy.dlspeed")},{value:"download_path",title:e("dashboard.sortBy.download_path")},{value:"downloaded",title:e("dashboard.sortBy.downloaded")},{value:"downloaded_session",title:e("dashboard.sortBy.downloaded_session")},{value:"eta",title:e("dashboard.sortBy.eta")},{value:"f_l_piece_prio",title:e("dashboard.sortBy.f_l_piece_prio")},{value:"force_start",title:e("dashboard.sortBy.force_start")},{value:"globalSpeed",title:e("dashboard.sortBy.globalSpeed")},{value:"globalVolume",title:e("dashboard.sortBy.globalVolume")},{value:"hash",title:e("dashboard.sortBy.hash")},{value:"infohash_v1",title:e("dashboard.sortBy.infohash_v1")},{value:"infohash_v2",title:e("dashboard.sortBy.infohash_v2")},{value:"last_activity",title:e("dashboard.sortBy.last_activity")},{value:"magnet_uri",title:e("dashboard.sortBy.magnet_uri")},{value:"max_ratio",title:e("dashboard.sortBy.max_ratio")},{value:"max_seeding_time",title:e("dashboard.sortBy.max_seeding_time")},{value:"name",title:e("dashboard.sortBy.name")},{value:"num_complete",title:e("dashboard.sortBy.num_complete")},{value:"num_incomplete",title:e("dashboard.sortBy.num_incomplete")},{value:"num_leechs",title:e("dashboard.sortBy.num_leechs")},{value:"num_seeds",title:e("dashboard.sortBy.num_seeds")},{value:"priority",title:e("dashboard.sortBy.priority")},{value:"progress",title:e("dashboard.sortBy.progress")},{value:"ratio",title:e("dashboard.sortBy.ratio")},{value:"ratio_limit",title:e("dashboard.sortBy.ratio_limit")},{value:"save_path",title:e("dashboard.sortBy.save_path")},{value:"seeding_time",title:e("dashboard.sortBy.seeding_time")},{value:"seeding_time_limit",title:e("dashboard.sortBy.seeding_time_limit")},{value:"seen_complete",title:e("dashboard.sortBy.seen_complete")},{value:"seq_dl",title:e("dashboard.sortBy.seq_dl")},{value:"size",title:e("dashboard.sortBy.size")},{value:"state",title:e("dashboard.sortBy.state")},{value:"super_seeding",title:e("dashboard.sortBy.super_seeding")},{value:"tags",title:e("dashboard.sortBy.tags")},{value:"time_active",title:e("dashboard.sortBy.time_active")},{value:"total_size",title:e("dashboard.sortBy.total_size")},{value:"tracker",title:e("dashboard.sortBy.tracker")},{value:"trackers_count",title:e("dashboard.sortBy.trackers_count")},{value:"up_limit",title:e("dashboard.sortBy.up_limit")},{value:"uploaded",title:e("dashboard.sortBy.uploaded")},{value:"uploaded_session",title:e("dashboard.sortBy.uploaded_session")},{value:"upspeed",title:e("dashboard.sortBy.upspeed")}].sort((v,s)=>v.title.localeCompare(s.title));$.splice(0,0,{value:"",title:e("dashboard.sortBy.default")});const b=E(!1),d=Ge({isVisible:!1,offset:[0,0]}),T=D({get:()=>_.textFilter,set:bt(v=>{_.textFilter=v??""},300)}),{paginatedResults:N,currentPage:F,pageCount:le}=ft(B,S.paginationSize,n),_e=D(()=>!!_.textFilter&&_.textFilter.length>0),ne=D(()=>B.value.length<=g.value.length);function G(v){b.value=v??!b.value,b.value&&Re(()=>{document.getElementById("searchInput")?.focus()})}function fe(v){h.toggleSelect(v)}function be(v){f.value||l.push({name:"torrentDetail",params:{hash:v}})}function ge(){_.textFilter=""}function Q(){window.scrollTo({top:0,behavior:"smooth"})}function se(){f.value&&h.unselectAllTorrents(),f.value=!f.value}function ye(){ne.value?h.unselectAllTorrents():h.selectTorrents(...B.value.map(v=>v.hash))}async function j(v,s){v.preventDefault(),d.isVisible&&(d.isVisible=!1,await Re()),d.isVisible=!0,d.offset=[v.pageX,v.pageY],f.value?g.value.length===0&&h.selectTorrent(s.hash):(h.unselectAllTorrents(),h.selectTorrent(s.hash))}ot(()=>d.isVisible,v=>{!v&&!f.value&&h.unselectAllTorrents()});function ie(v){if(k.hasActiveDialog)return!1;const s=v.target;if(Be(v)&&v.key==="a"&&s.tagName!=="INPUT")return h.unselectAllTorrents(),h.selectTorrents(...B.value.map(u=>u.hash)),v.preventDefault(),!0;if(Be(v)&&v.key==="f"){const u=document.getElementById("searchInput");if(document.activeElement!==u)return G(!0),v.preventDefault(),!0}if(v.key==="Escape"){const u=document.getElementById("searchInput");return document.activeElement===u||b.value?G(!1):(f.value=!1,h.unselectAllTorrents()),v.preventDefault(),!0}if(v.key==="Delete")return g.value.length===0?void 0:(k.createDialog(Qe,{hashes:g.value}),v.preventDefault(),!0);if(v.key==="/"){const u=document.getElementById("searchInput");return document.activeElement!==u&&!b.value&&(l.push({name:"searchEngine"}),v.preventDefault()),!0}}me(async()=>{await _.fetchCategories(),await _.fetchTags(),G(_e.value)}),je(()=>{document.addEventListener("keydown",ie),f.value=!1,Q()}),lt(()=>{document.removeEventListener("keydown",ie)});const re=E();function ke(v,s){re.value=setTimeout(()=>{j(v,s)},500)}function Z(){clearTimeout(re.value)}return(v,s)=>(c(),w(W,null,[p("div",ga,[t(Se,{class:"ma-0 pa-0 mb-2"},{default:a(()=>[t(Fe,null,{default:a(()=>[Te(t(z,{color:"transparent"},{default:a(()=>[t(q,{id:"searchInput",modelValue:T.value,"onUpdate:modelValue":s[0]||(s[0]=u=>T.value=u),label:i(e)("dashboard.searchInputLabel"),clearable:"",density:"compact","hide-details":"","prepend-inner-icon":"mdi-magnify",rounded:"pill","single-line":"",style:{width:"200px"},variant:"solo","onClick:clear":s[1]||(s[1]=u=>ge())},null,8,["modelValue","label"])]),_:1},512),[[Ve,b.value]])]),_:1}),t(K,{text:i(e)("dashboard.toggleSearchFilter"),location:"top"},{activator:a(({props:u})=>[t(P,R({icon:b.value?"mdi-chevron-left-circle":"mdi-text-box-search"},u,{variant:"plain",onClick:s[2]||(s[2]=x=>G())}),null,16,["icon"])]),_:1},8,["text"]),t(K,{text:i(e)("dashboard.toggleSelectMode"),location:"top"},{activator:a(({props:u})=>[t(P,R({icon:i(f)?"mdi-checkbox-marked":"mdi-checkbox-blank-outline"},u,{variant:"plain",onClick:se}),null,16,["icon"])]),_:1},8,["text"]),t(K,{text:i(e)("dashboard.toggleSortOrder"),location:"top"},{activator:a(({props:u})=>[t(P,R({icon:i(y).reverseOrder?"mdi-arrow-up-thin":"mdi-arrow-down-thin"},u,{variant:"plain",onClick:s[3]||(s[3]=x=>i(y).reverseOrder=!i(y).reverseOrder)}),null,16,["icon"])]),_:1},8,["text"]),p("div",ya,[t(vt,{modelValue:i(y).sortBy,"onUpdate:modelValue":s[4]||(s[4]=u=>i(y).sortBy=u),items:i($),label:i(e)("dashboard.sortLabel"),"auto-select-first":"",density:"compact","hide-details":"",variant:"solo-filled"},null,8,["modelValue","items","label"])]),t(de,{class:"align-center justify-center"},{default:a(()=>[p("span",ka,m(i(o)),1)]),_:1})]),_:1}),t(Se,{class:"ma-0 pa-0"},{default:a(()=>[t(ht,null,{default:a(()=>[Te(t(z,{color:"transparent"},{default:a(()=>[t(K,{text:i(e)("common.selectAll"),location:"bottom"},{activator:a(({props:u})=>[t(P,R({icon:ne.value?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",class:"text-grey",color:"transparent",style:{left:"-8px"}},u,{onClick:ye}),null,16,["icon"])]),_:1},8,["text"]),p("span",Ta,m(i(e)("dashboard.selectAll")),1)]),_:1},512),[[Ve,i(f)]])]),_:1})]),_:1}),i(B).length===0?(c(),w("div",Va,[p("p",$a,m(i(e)("common.emptyList")),1)])):(c(),w("div",wa,[t(Ie,{id:"torrentList",class:"pa-0",color:"transparent"},{default:a(()=>[i(S).isPaginationOnTop&&!i(S).isInfiniteScrollActive?(c(),C(ee,{key:0},{default:a(()=>[t(Oe,{modelValue:i(F),"onUpdate:modelValue":s[5]||(s[5]=u=>te(F)?F.value=u:null),length:i(le),"next-icon":"mdi-menu-right","prev-icon":"mdi-menu-left",onInput:Q},null,8,["modelValue","length"])]),_:1})):O("",!0),(c(!0),w(W,null,ae(i(N),u=>(c(),C(ee,{id:`torrent-${u.hash}`,class:He([i(r).mobile?"mb-2":"mb-4","pa-0"]),onContextmenu:x=>j(x,u),onTouchcancel:Z,onTouchend:Z,onTouchmove:Z,onTouchstart:x=>ke(x,u),onDblclick:H(x=>be(u.hash),["prevent"])},{default:a(()=>[p("div",xa,[t(Fe,null,{default:a(()=>[Te(t(z,{class:"mr-3",color:"transparent"},{default:a(()=>[t(P,{icon:i(h).isTorrentInSelection(u.hash)?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",color:"transparent",variant:"flat",onClick:x=>fe(u.hash)},null,8,["icon","onClick"])]),_:2},1536),[[Ve,i(f)]])]),_:2},1024),t(na,{torrent:u},null,8,["torrent"])])]),_:2},1032,["id","class","onContextmenu","onTouchstart","onDblclick"]))),256)),!i(S).isPaginationOnTop&&!i(S).isInfiniteScrollActive?(c(),C(ee,{key:1},{default:a(()=>[t(Oe,{modelValue:i(F),"onUpdate:modelValue":s[6]||(s[6]=u=>te(F)?F.value=u:null),length:i(le),"next-icon":"mdi-menu-right","prev-icon":"mdi-menu-left",onInput:Q},null,8,["modelValue","length"])]),_:1})):O("",!0)]),_:1})]))]),p("div",{style:nt(`position: absolute; left: ${d.offset[0]}px; top: ${d.offset[1]}px;`)},[t(ba,{modelValue:d.isVisible,"onUpdate:modelValue":s[7]||(s[7]=u=>d.isVisible=u)},null,8,["modelValue"])],4)],64))}});export{Aa as default};
