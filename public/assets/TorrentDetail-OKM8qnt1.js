import{_ as ot,a as nt}from"./MoveTorrentDialog.vue_vue_type_script_setup_true_lang-CKF6OA4H.js";import{aN as Ae,A as De,h as z,f as J,aO as G,I as rt,T as it,N as q,_ as pe,aP as st,p as re,al as ut,w as T,r as me,b as be,aq as dt,ar as X,as as Z,v as A,G as Le,a4 as de,O as Q,i as ie,j as H,aH as ke,B as ne,y as He,E as ct,F as ft,aQ as vt,ak as pt,l as we,aR as mt,aS as _t,g as U,aT as gt,aU as ht,H as Ce,aV as yt,m as ce,z as kt,a5 as Se,an as Ke,aW as wt,aX as Te,q as Ne,ah as Ye,a9 as qe,o as Pe,aY as Re,a2 as Ee,n as Dt,V as We,aB as bt,C as $t,aC as Vt,aD as Tt,aE as oe}from"./index-ZTxPJY2r.js";import{g as K,K as _e,c as R,a3 as r,a8 as h,ab as s,Y as Oe,a4 as D,a5 as t,W as p,Z as l,aa as B,u as a,a7 as fe,m as e,ao as Xe,a0 as Ct,w as ve,x as xe,I as $e,A as Ze,a6 as Me,a9 as E,au as St,F,d as O,a2 as Ge,N as ze,n as Ie,r as Nt,ap as Pt,$ as Ot,a as It,q as At}from"./vue-OSX-kU20.js";import{Z as Qe,ap as xt}from"./vuetify-fidQOeXI.js";import{_ as zt}from"./MoveTorrentFileDialog.vue_vue_type_script_setup_true_lang-l6LUcEzg.js";var ye=(y=>(y[y.MISSING=0]="MISSING",y[y.DOWNLOADING=1]="DOWNLOADING",y[y.DOWNLOADED=2]="DOWNLOADED",y))(ye||{}),Y=(y=>(y[y.DISABLED=0]="DISABLED",y[y.NOT_YET_CONTACTED=1]="NOT_YET_CONTACTED",y[y.WORKING=2]="WORKING",y[y.UPDATING=3]="UPDATING",y[y.NOT_WORKING=4]="NOT_WORKING",y))(Y||{});const Bt={pdf:"mdi-file-pdf-box",png:"mdi-file-image",jpg:"mdi-file-image",jpeg:"mdi-file-image",tiff:"mdi-file-image",doc:"mdi-file-document",docx:"mdi-file-document",txt:"mdi-file-document",nfo:"mdi-information-variant-box",mp3:"mdi-music",wav:"mdi-music",flac:"mdi-music",avi:"mdi-movie",mp4:"mdi-movie",mkv:"mdi-movie",mov:"mdi-movie",wmv:"mdi-movie",srt:"mdi-subtitles",idx:"mdi-subtitles",sub:"mdi-subtitles",rar:"mdi-zip-box-outline",zip:"mdi-zip-box-outline",gz:"mdi-zip-box-outline","7z":"mdi-zip-box-outline",iso:"mdi-zip-box-outline",exe:"mdi-application-brackets",msi:"mdi-application-brackets",dmg:"mdi-application-brackets",deb:"mdi-application-brackets",jar:"mdi-application-brackets"};function Ut(y){const d=y.split(".").pop()?.toLowerCase()||"";return Bt[d]||"mdi-file"}const Ft={class:"d-flex"},Lt={class:"d-flex flex-column overflow-hidden text-no-wrap mr-3"},Rt={class:"text-grey"},Et={class:"d-flex align-center"},je="#ffe476",Wt=K({__name:"ContentNode",props:{node:{},openedItems:{}},emits:["setFilePrio","onRightClick"],setup(y,{emit:d}){const c=y,_=d,{t:C}=_e(),{mobile:I}=Qe(),N=Ae(),v=De(),f=R(()=>{if(c.node.name==="(root)")return 0;const i=c.node.fullName.split("/").length,o=I.value?12:24;return i*o});function $(i,o){if(o.type==="file")return;i.stopPropagation();const m=c.openedItems.indexOf(o.fullName);m===-1?c.openedItems.push(o.fullName):c.openedItems.splice(m,1)}async function w(i){i.getPriority()===G.DO_NOT_DOWNLOAD?_("setFilePrio",i.getChildrenIds(),G.NORMAL):_("setFilePrio",i.getChildrenIds(),G.DO_NOT_DOWNLOAD)}function b(i,o){it(i)?N.internalSelection.has(o.fullName)?N.internalSelection.delete(o.fullName):N.internalSelection.add(o.fullName):N.internalSelection=new Set([o.fullName])}function g(i){return i.getPriority()===G.DO_NOT_DOWNLOAD?"grey":i.getProgress()===1?"green":""}function S(i){const[o,m]=i.getDeepCount(),u=[];return o>1&&u.push(C("torrentDetail.content.folderInfo",o-1)),m>0&&u.push(C("torrentDetail.content.fileInfo",m)),u.join(", ")}function V(i){const o=[q(i.getSize(),v.useBinarySize)];return i.type==="folder"&&o.push(S(i)),o.join(" | ")}return(i,o)=>(r(),h("div",{class:fe(["d-flex flex-column py-2 pr-3",i.node.isSelected(a(N).internalSelection)?"selected":""]),style:Xe(`padding-left: ${f.value}px`),onClick:o[2]||(o[2]=Oe(m=>b(m,i.node),["stop"])),onContextmenu:o[3]||(o[3]=m=>i.$emit("onRightClick",m,i.node))},[s("div",Ft,[s("div",{class:"d-flex align-center",onClick:o[0]||(o[0]=Oe(m=>w(i.node),["stop"]))},[i.node.isWanted()===null?(r(),D(z,{key:0,color:g(i.node),icon:"mdi-checkbox-intermediate-variant"},null,8,["color"])):i.node.isWanted()?(r(),D(z,{key:1,color:g(i.node),icon:"mdi-checkbox-marked"},null,8,["color"])):(r(),D(z,{key:2,color:g(i.node),icon:"mdi-checkbox-blank-outline"},null,8,["color"]))]),s("div",{class:"d-flex align-center spacer",onClick:o[1]||(o[1]=m=>$(m,i.node))},[i.node.type==="folder"?(r(),D(z,{key:0},{default:t(()=>[p(l(i.openedItems.includes(i.node.fullName)?"mdi-chevron-up":"mdi-chevron-down"),1)]),_:1})):B("",!0),i.node.name==="(root)"?(r(),D(z,{key:1,icon:"mdi-file-tree"})):i.node.type==="file"?(r(),D(z,{key:2,icon:a(Ut)(i.node.name)},null,8,["icon"])):i.openedItems.includes(i.node.fullName)?(r(),D(z,{key:3,icon:"mdi-folder-open",color:je})):(r(),D(z,{key:4,icon:"mdi-folder",color:je}))]),s("div",Lt,[s("div",{class:fe(`text-${g(i.node)}`)},l(i.node.name),3),s("div",Rt,l(V(i.node)),1)]),e(J),s("div",Et,[i.node.getPriority()===a(G).MAXIMAL?(r(),D(z,{key:0,color:"error"},{default:t(()=>[p("mdi-arrow-up")]),_:1})):i.node.getPriority()===a(G).HIGH?(r(),D(z,{key:1,color:"warning"},{default:t(()=>[p("mdi-arrow-top-right")]),_:1})):i.node.getPriority()===a(G).NORMAL?(r(),D(z,{key:2},{default:t(()=>[p("mdi-minus")]),_:1})):i.node.getPriority()===a(G).MIXED?(r(),D(z,{key:3},{default:t(()=>[p("mdi-tilde")]),_:1})):i.node.getPriority()===a(G).DO_NOT_DOWNLOAD?(r(),D(z,{key:4,color:"grey"},{default:t(()=>[p("mdi-cancel")]),_:1})):B("",!0)])]),e(rt,{"model-value":i.node.getProgress(),max:1,color:g(i.node),rounded:"sm"},null,8,["model-value","color"])],38))}}),Mt=pe(Wt,[["__scopeId","data-v-4821ee2d"]]),Gt=K({__name:"Content",props:{torrent:{},isActive:{type:Boolean}},setup(y){const d=y,{height:c}=Qe(),_=Ae(),{rightClickProperties:C,openedItems:I,flatTree:N,internalSelection:v}=Ct(_),f=R(()=>c.value-48*2-64-12*2);async function $(w,b){C.value.isVisible&&(C.value.isVisible=!1,await Ze()),Object.assign(C.value,{isVisible:!0,offset:[w.pageX,w.pageY],hash:d.torrent.hash}),v.value.size<=1&&(v.value=new Set([b.fullName]))}return ve(()=>d.isActive,w=>{w?(_.resumeTimer(),_.updateFileTree()):_.pauseTimer()}),xe(()=>{v.value.clear(),_.resumeTimer()}),$e(()=>_.$reset()),(w,b)=>(r(),D(re,null,{default:t(()=>[e(st,{id:"tree-root",items:a(N),height:f.value,"item-height":"68",class:"pa-2"},{default:t(({item:g})=>[e(Mt,{"opened-items":a(I),node:g,onSetFilePrio:b[0]||(b[0]=(S,V)=>a(_).setFilePriority(S,V)),onOnRightClick:b[1]||(b[1]=(S,V)=>$(S,V))},null,8,["opened-items","node"])]),_:1},8,["items","height"])]),_:1}))}}),jt={class:"pl-4"},Ht={class:"pr-4"},j=K({__name:"InfoBase",props:{compact:{type:Boolean}},setup(y){return(d,c)=>(r(),D(T,{cols:"12",sm:"6",lg:"3"},{default:t(()=>[e(ut,{rounded:"xl",class:"d-flex align-center py-2 border"},{default:t(()=>[s("div",jt,[Me(d.$slots,"title")]),e(J),s("div",Ht,[Me(d.$slots,"text")])]),_:3})]),_:3}))}}),Kt={key:0,class:"d-flex gap"},Yt=K({__name:"Info",props:{torrent:{},isActive:{type:Boolean}},setup(y){const d=y,c=me(),_=be(),C=De(),I=R({get:()=>d.torrent.auto_tmm,set:o=>c.toggleAutoTmm([d.torrent.hash],o)}),N=R({get:()=>d.torrent.f_l_piece_prio,set:()=>c.toggleFLPiecePrio([d.torrent.hash])}),v=R({get:()=>d.torrent.forced,set:o=>{o?_.forceResumeTorrents([d.torrent.hash]):_.resumeTorrents([d.torrent.hash])}}),f=R({get:()=>d.torrent.seq_dl,set:()=>c.toggleSeqDl([d.torrent.hash])}),$=R({get:()=>d.torrent.super_seeding,set:o=>c.setSuperSeeding([d.torrent.hash],o)}),w=[{title:"added_on",text:"added_on"},{title:"completed_on",text:"completed_on"},{title:"last_activity",text:"last_activity"},{title:"seen_complete",text:"seen_complete"}],b=[{title:"ratio_time_limit",text:"ratio_time_limit"},{title:"seeding_time",text:"seeding_time"},{title:"time_active",text:"time_active"}],g=[{title:"downloaded",text:"downloaded"},{title:"downloaded_session",text:"downloaded_session"},{title:"uploaded",text:"uploaded"},{title:"uploaded_session",text:"uploaded_session"},{title:"size",text:"size"},{title:"total_size",text:"total_size"},{title:"amount_left",text:"amount_left"},{title:"global_volume",text:"globalVolume"}],S=[{title:"download_limit",text:"dl_limit"},{title:"download_speed",text:"dlspeed"},{title:"upload_limit",text:"up_limit"},{title:"upload_speed",text:"upspeed"},{title:"avg_download_speed",text:"avgDownloadSpeed"},{title:"avg_upload_speed",text:"avgUploadSpeed"},{title:"global_speed",text:"globalSpeed"}],V=[{title:"available_peers",text:"available_peers"},{title:"available_seeds",text:"available_seeds"},{title:"num_leechs",text:"num_leechs"},{title:"num_seeds",text:"num_seeds"},{title:"ratio",text:"ratio"},{title:"ratio_limit",text:"ratio_limit"},{title:"availability",text:"availability"},{title:"eta",text:"eta"},{title:"category",text:"category"},{title:"state",text:"stateString"},{title:"trackers_count",text:"trackers_count"},{title:"priority",text:"priority"}],i=[{title:"content_path",text:"content_path"},{title:"download_path",text:"download_path"},{title:"hash",text:"hash"},{title:"infohash_v1",text:"infohash_v1"},{title:"infohash_v2",text:"infohash_v2"},{title:"magnet",text:"magnet"},{title:"name",text:"name"},{title:"save_path",text:"savePath"},{title:"tracker",text:"tracker"}];return(o,m)=>(r(),D(ie,null,{default:t(()=>[e(H,null,{default:t(()=>[e(dt,null,{default:t(()=>[e(X,{title:o.$t("torrentDetail.info.datetime_values")},{default:t(()=>[e(Z,null,{default:t(()=>[e(A,null,{default:t(()=>[(r(),h(F,null,E(w,u=>e(j,null,St({title:t(()=>[p(l(o.$t(`torrent.properties.${u.title}`)),1)]),_:2},[o.torrent[u.text]>0?{name:"text",fn:t(()=>[p(l(a(Le)(o.torrent[u.text]*1e3).format(a(C).dateFormat??"DD/MM/YYYY, HH:mm:ss")),1)]),key:"0"}:{name:"text",fn:t(()=>[p(l(o.$t("common.NA")),1)]),key:"1"}]),1024)),64))]),_:1})]),_:1})]),_:1},8,["title"]),e(X,{title:o.$t("torrentDetail.info.duration_values")},{default:t(()=>[e(Z,null,{default:t(()=>[e(A,null,{default:t(()=>[(r(),h(F,null,E(b,u=>e(j,null,{title:t(()=>[p(l(o.$t(`torrent.properties.${u.title}`)),1)]),text:t(()=>[p(l(a(Le).duration(o.torrent[u.text],"s").humanize()),1)]),_:2},1024)),64))]),_:1})]),_:1})]),_:1},8,["title"]),e(X,{title:o.$t("torrentDetail.info.boolean_values")},{default:t(()=>[e(Z,null,{default:t(()=>[e(A,null,{default:t(()=>[e(j,null,{title:t(()=>[e(de,{modelValue:I.value,"onUpdate:modelValue":m[0]||(m[0]=u=>I.value=u),"hide-details":"",density:"compact",label:o.$t("torrent.properties.auto_tmm")},null,8,["modelValue","label"])]),_:1}),e(j,null,{title:t(()=>[e(de,{modelValue:N.value,"onUpdate:modelValue":m[1]||(m[1]=u=>N.value=u),"hide-details":"",density:"compact",label:o.$t("torrent.properties.f_l_piece_prio")},null,8,["modelValue","label"])]),_:1}),e(j,null,{title:t(()=>[e(de,{modelValue:v.value,"onUpdate:modelValue":m[2]||(m[2]=u=>v.value=u),"hide-details":"",density:"compact",label:o.$t("torrent.properties.forced")},null,8,["modelValue","label"])]),_:1}),e(j,null,{title:t(()=>[e(de,{modelValue:f.value,"onUpdate:modelValue":m[3]||(m[3]=u=>f.value=u),"hide-details":"",density:"compact",label:o.$t("torrent.properties.seq_dl")},null,8,["modelValue","label"])]),_:1}),e(j,null,{title:t(()=>[e(de,{modelValue:$.value,"onUpdate:modelValue":m[4]||(m[4]=u=>$.value=u),"hide-details":"",density:"compact",label:o.$t("torrent.properties.super_seeding")},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1})]),_:1},8,["title"]),e(X,{title:o.$t("torrentDetail.info.data_values")},{default:t(()=>[e(Z,null,{default:t(()=>[e(A,null,{default:t(()=>[(r(),h(F,null,E(g,u=>e(j,null,{title:t(()=>[p(l(o.$t(`torrent.properties.${u.title}`)),1)]),text:t(()=>[p(l(a(q)(o.torrent[u.text],a(C).useBinarySize)),1)]),_:2},1024)),64))]),_:1})]),_:1})]),_:1},8,["title"]),e(X,{title:o.$t("torrentDetail.info.speed_values")},{default:t(()=>[e(Z,null,{default:t(()=>[e(A,null,{default:t(()=>[(r(),h(F,null,E(S,u=>e(j,null,{title:t(()=>[p(l(o.$t(`torrent.properties.${u.title}`)),1)]),text:t(()=>[p(l(a(Q)(o.torrent[u.text],a(C).useBitSpeed)),1)]),_:2},1024)),64))]),_:1})]),_:1})]),_:1},8,["title"]),e(X,{title:o.$t("torrentDetail.info.text_values")},{default:t(()=>[e(Z,null,{default:t(()=>[e(A,null,{default:t(()=>[(r(),h(F,null,E(V,u=>e(j,null,{title:t(()=>[p(l(o.$t(`torrent.properties.${u.title}`)),1)]),text:t(()=>[p(l(o.torrent[u.text]),1)]),_:2},1024)),64))]),_:1})]),_:1})]),_:1},8,["title"]),e(X,{title:o.$t("torrentDetail.info.long_text_values")},{default:t(()=>[e(Z,null,{default:t(()=>[e(ie,null,{default:t(()=>[(r(),h(F,null,E(i,u=>e(H,{title:o.$t(`torrent.properties.${u.title}`)},{default:t(()=>[e(ke,null,{default:t(()=>[p(l(o.torrent[u.text]),1)]),_:2},1024)]),_:2},1032,["title"])),64)),e(H,{title:o.$t("torrent.properties.tags")},{default:t(()=>[o.torrent.tags?.length?(r(),h("div",Kt,[(r(!0),h(F,null,E(o.torrent.tags,u=>(r(),D(ne,{variant:"flat",color:"tag"},{default:t(()=>[p(l(u),1)]),_:2},1024))),256))])):(r(),D(ke,{key:1},{default:t(()=>[p(l(o.$t("torrent.properties.empty_tags")),1)]),_:1}))]),_:1},8,["title"])]),_:1})]),_:1})]),_:1},8,["title"])]),_:1})]),_:1})]),_:1}))}}),qt=pe(Yt,[["__scopeId","data-v-bb1329d2"]]),Xt=["href"],Zt={key:1},Qt={class:"my-1"},Jt={class:"mr-2"},el={key:0},tl={key:2},ll={key:0},al={key:1},ol={key:2},nl={key:3},rl={key:4},il={key:0},sl=K({__name:"Overview",props:{torrent:{},isActive:{type:Boolean}},setup(y){const d=y,{t:c}=_e(),_=xt(),C=He(),I=me(),N=be(),v=De(),f=O(),$=O(""),w=O(0),b=O([]),g=O(0),S=O(0),V=O(""),i=O(0),o=O(0),m=O(0),u=O(0),ee=R(()=>`torrent-${d.torrent.state}`),te=R(()=>`${parseInt(ct(i.value,!0))} ${ft(i.value,!0)}`),k=R(()=>d.torrent.state===vt.META_DL),x=R(()=>!k.value&&m.value>0&&m.value<v.canvasRenderThreshold),P=R(()=>x.value&&m.value<v.canvasRefreshThreshold);async function ge(){const n=await N.getTorrentProperties(d.torrent.hash);$.value=n.comment,w.value=n.dl_speed_avg,m.value=n.pieces_num,o.value=n.pieces_have,i.value=n.piece_size,u.value=n.up_speed_avg}async function M(){b.value=await I.fetchFiles(d.torrent.hash),S.value=b.value.length;const n=b.value.filter(W=>W.priority!==G.DO_NOT_DOWNLOAD);g.value=n.length,g.value===1&&(V.value=n[0].name)}async function Be(){if(!f.value)return;const n=await I.fetchPieceState(d.torrent.hash);f.value.width=n.length||-1;const W=f.value.getContext("2d");W.clearRect(0,0,f.value.width,f.value.height);let L="",le=1;for(let ae=0;ae<n.length;++ae){const Ve=n[ae];let se="";if(Ve===ye.DOWNLOADING)se=_.current.value.colors["torrent-downloading"];else if(Ve===ye.DOWNLOADED)se=_.current.value.colors["torrent-pausedUP"];else if(Ve===ye.MISSING){const lt=b.value.filter(ue=>ue.priority!==G.DO_NOT_DOWNLOAD).map(ue=>ue.piece_range);for(const[ue,at]of lt)if(ae>ue&&ae<at){se=_.current.value.colors["torrent-pausedDL"];break}}if(se===L){++le;continue}L!==""&&(W.fillStyle=L,W.fillRect(ae-le,0,le,f.value.height)),le=1,L=se}L!==""&&(W.fillStyle=L,W.fillRect(n.length-le,0,le,f.value.height))}async function Je(){try{await navigator.clipboard.writeText(d.torrent.hash)}catch{Ge.error(c("toast.copy.error"));return}Ge.success(c("toast.copy.success"))}function he(n){C.createDialog(ot,{hashes:[d.torrent.hash],mode:n})}function Ue(){C.createDialog(zt,{hash:d.torrent.hash,isFolder:!1,oldName:V.value})}const{resume:et,pause:tt}=pt(async()=>{await M(),P.value&&await Be()},v.fileContentInterval,{immediate:!0,immediateCallback:!0});ve(()=>d.isActive,n=>{n?et():tt()}),ve(()=>d.torrent,async()=>{await ge()});function Fe(n){if(C.hasActiveDialog)return!1;if(n.key==="d")return n.preventDefault(),he("dl"),!0;if(n.key==="s")return n.preventDefault(),he("save"),!0;if(n.key==="f"&&g.value===1)return n.preventDefault(),Ue(),!0}return xe(()=>{document.addEventListener("keydown",Fe)}),$e(()=>{document.removeEventListener("keydown",Fe)}),(n,W)=>n.torrent?(r(),D(re,{key:0},{default:t(()=>[e(we,{class:"text-wrap"},{default:t(()=>[p(l(n.torrent.name),1)]),_:1}),e(gt,null,{default:t(()=>[s("div",null,[(r(!0),h(F,null,E(a(_t)($.value),L=>(r(),h("span",null,[a(mt)(L)?(r(),h("a",{key:0,target:"_blank",href:L},l(L),9,Xt)):(r(),h("span",Zt,l(L),1))]))),256))]),s("div",Qt,[s("span",Jt,l(n.torrent.hash),1),e(U,{variant:"outlined",rounded:"",onClick:Je},{default:t(()=>[p(l(n.$t("torrentDetail.overview.copy_hash")),1)]),_:1})])]),_:1}),e(ce,null,{default:t(()=>[e(A,null,{default:t(()=>[e(T,{cols:"12",md:"6"},{default:t(()=>[e(A,null,{default:t(()=>[e(T,{cols:"4"},{default:t(()=>[e(ht,{color:ee.value,indeterminate:k.value,size:100,"model-value":n.torrent?.progress*100||0,width:15},{default:t(()=>[k.value?(r(),h("span",el,l(n.$t("torrentDetail.overview.fetchingMetadata")),1)):n.torrent.progress===1?(r(),D(z,{key:1,icon:"mdi-check",size:"x-large"})):(r(),h("span",tl,l(a(Ce)(n.torrent.progress)),1))]),_:1},8,["color","indeterminate","model-value"])]),_:1}),e(T,{cols:"8",class:"d-flex flex-column align-center justify-center"},{default:t(()=>[k.value?(r(),h("div",ll,[s("span",null,l(n.$t("torrentDetail.overview.waitingForMetadata")),1)])):x.value?(r(),h("div",al,[s("canvas",{ref_key:"canvas",ref:f,width:"0",height:"10"},null,512)])):B("",!0),!k.value&&!x.value?(r(),h("div",ol,[s("span",null,l(n.$t("torrentDetail.overview.canvasRenderDisabled")),1)])):!k.value&&!P.value?(r(),h("div",nl,[s("span",null,l(n.$t("torrentDetail.overview.canvasRefreshDisabled")),1)])):B("",!0),m.value>0?(r(),h("div",rl,[s("span",null,l(a(c)("torrentDetail.overview.pieceCount",{owned:o.value,total:m.value,pieceSize:te.value})),1)])):B("",!0),s("div",null,[e(z,{icon:"mdi-arrow-down"}),p(" "+l(a(Q)(n.torrent.dlspeed,a(v).useBitSpeed))+" ",1),e(z,{icon:"mdi-arrow-up"}),p(" "+l(a(Q)(n.torrent.upspeed,a(v).useBitSpeed)),1)])]),_:1})]),_:1}),e(A,null,{default:t(()=>[e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrent.properties.download_path"))+":",1),s("div",null,l(n.torrent.download_path),1),e(U,{icon:"mdi-pencil",color:"accent",size:"x-small",onClick:W[0]||(W[0]=L=>he("dl"))})]),_:1}),e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrentDetail.overview.fileCount"))+":",1),s("div",null,l(g.value)+" / "+l(S.value),1),g.value===1?(r(),h("div",il,l(V.value),1)):B("",!0),g.value===1?(r(),D(U,{key:1,icon:"mdi-pencil",color:"accent",size:"x-small",onClick:Ue})):B("",!0)]),_:1})]),_:1}),e(A,null,{default:t(()=>[e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrent.properties.save_path"))+":",1),s("div",null,l(n.torrent.savePath),1),e(U,{icon:"mdi-pencil",color:"accent",size:"x-small",onClick:W[1]||(W[1]=L=>he("save"))})]),_:1}),e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrent.properties.content_path"))+":",1),s("div",null,l(n.torrent.content_path),1)]),_:1})]),_:1})]),_:1}),e(T,{cols:"12",md:"6"},{default:t(()=>[e(A,null,{default:t(()=>[e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrent.properties.state"))+":",1),e(ne,{variant:"flat",color:ee.value},{default:t(()=>[p(l(n.$t(`torrent.state.${n.torrent.state}`)),1)]),_:1},8,["color"])]),_:1}),e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrent.properties.category"))+":",1),e(ne,{variant:"flat",color:"category"},{default:t(()=>[p(l(n.torrent.category.length?n.torrent.category:n.$t("navbar.side.filters.uncategorized")),1)]),_:1})]),_:1})]),_:1}),e(A,null,{default:t(()=>[e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrent.properties.tracker"))+":",1),e(ne,{variant:"flat",color:"tracker"},{default:t(()=>[p(l(n.torrent.tracker?a(yt)(n.torrent.tracker):n.$t("navbar.side.filters.untracked")),1)]),_:1})]),_:1}),e(T,{cols:"6",class:"d-flex flex-wrap chipgap"},{default:t(()=>[s("div",null,l(n.$t("torrent.properties.tags"))+":",1),n.torrent.tags?(r(!0),h(F,{key:0},E(n.torrent.tags,L=>(r(),D(ne,{key:L,variant:"flat",color:"tag"},{default:t(()=>[p(l(L),1)]),_:2},1024))),128)):B("",!0),!n.torrent.tags||n.torrent.tags.length===0?(r(),D(ne,{key:1,variant:"flat",color:"tag"},{default:t(()=>[p(l(n.$t("navbar.side.filters.untagged")),1)]),_:1})):B("",!0)]),_:1})]),_:1}),e(A,null,{default:t(()=>[e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrentDetail.overview.selectedFileSize"))+":",1),s("div",null,l(a(q)(n.torrent.size,a(v).useBinarySize))+" / "+l(a(q)(n.torrent.total_size,a(v).useBinarySize)),1)]),_:1}),e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrentDetail.overview.ratio"))+":",1),s("div",null,l(n.torrent.ratio),1)]),_:1})]),_:1}),e(A,null,{default:t(()=>[e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrentDetail.overview.downloaded"))+":",1),s("div",null,l(a(q)(n.torrent.downloaded,a(v).useBinarySize)),1)]),_:1}),e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrentDetail.overview.uploaded"))+":",1),s("div",null,l(a(q)(n.torrent.uploaded,a(v).useBinarySize)),1)]),_:1})]),_:1}),e(A,null,{default:t(()=>[e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrentDetail.overview.dlSpeedAverage"))+":",1),s("div",null,l(a(Q)(w.value,a(v).useBitSpeed)),1)]),_:1}),e(T,{cols:"6"},{default:t(()=>[s("div",null,l(n.$t("torrentDetail.overview.upSpeedAverage"))+":",1),s("div",null,l(a(Q)(u.value,a(v).useBitSpeed)),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})):B("",!0)}}),ul=pe(sl,[["__scopeId","data-v-a676963e"]]),dl={class:"d-flex"},cl={key:0},fl=["alt","src","title"],vl=["title"],pl={class:"text-subtitle-2 text-grey"},ml=["title"],_l={class:"d-flex flex-column"},gl={class:"text-h5"},hl=K({__name:"Peers",props:{torrent:{},isActive:{type:Boolean}},setup(y){const d=y,{t:c}=_e(),_=me(),C=kt(),I=De(),N=O(!1),v=O([]),f=O(""),$=O(null),w=O(!1);async function b(){N.value=!0,v.value=Object.entries((await _.getTorrentPeers(d.torrent.hash)).peers).map(([o,m])=>({...m,host:o})),N.value=!1}async function g(){f.value.length&&(await _.addTorrentPeers(d.torrent.hash,f.value.split(`
`)),await b(),S())}function S(){w.value=!1,f.value=""}async function V(o){await _.banPeers([o.host]),await C.fetchPreferences(),await b()}async function i(o){o??d.isActive?(await b(),$.value=setInterval(b,5e3)):(clearInterval($.value),$.value=null)}return ze(i),$e(()=>i(!1)),ve(()=>d.isActive,i),(o,m)=>(r(),D(ie,null,{default:t(()=>[(r(!0),h(F,null,E(v.value,(u,ee)=>(r(),h(F,null,[ee>0?(r(),D(Se,{key:0,color:"white"})):B("",!0),e(H,null,{default:t(()=>[s("div",dl,[s("div",null,[e(Ke,{class:"overflow-visible"},{default:t(()=>[u.country_code?(r(),h("span",cl,[a(wt)?(r(),h("img",{key:0,alt:a(Te)(u.country_code).char,src:a(Te)(u.country_code).url,title:u.country,style:{"max-width":"32px"}},null,8,fl)):(r(),h("span",{key:1,title:u.country},l(a(Te)(u.country_code).char),9,vl))])):B("",!0),s("span",null,l(u.ip),1),s("span",pl," :"+l(u.port),1)]),_:2},1024),e(ke,{class:"d-block"},{default:t(()=>[s("div",null,[p(" Flags: "),s("span",{class:"cursor-help",title:u.flags_desc},l(u.flags),9,ml)]),s("div",null,"Progress: "+l(a(Ce)(u.progress)),1),s("div",null,[e(z,{icon:"mdi-arrow-down",color:"download"}),p(" "+l(a(Q)(u.dl_speed,a(I).useBitSpeed))+" ",1),e(z,{icon:"mdi-arrow-up",color:"upload"}),p(" "+l(a(Q)(u.up_speed,a(I).useBitSpeed)),1)]),s("div",null,l(a(q)(u.downloaded,a(I).useBinarySize))+" | "+l(a(q)(u.uploaded,a(I).useBinarySize)),1),s("div",null,"Relevance: "+l(a(Ce)(u.relevance)),1)]),_:2},1024)]),e(J),s("div",_l,[e(U,{color:"red",icon:"mdi-cancel",variant:"text",onClick:te=>V(u)},null,8,["onClick"])])])]),_:2},1024)],64))),256)),v.value.length===0?(r(),D(H,{key:0},{default:t(()=>[p(l(o.$t("torrentDetail.peers.emptyList")),1)]),_:1})):B("",!0),e(H,null,{default:t(()=>[s("div",{class:fe(["d-flex gap py-5",o.$vuetify.display.mobile?"flex-column":"justify-space-evenly"])},[e(Ne,{modelValue:w.value,"onUpdate:modelValue":m[1]||(m[1]=u=>w.value=u),"max-width":"750px"},{activator:t(({props:u})=>[e(U,Ie(u,{variant:"flat",text:a(c)("torrentDetail.peers.addPeers.title"),color:"accent"}),null,16,["text"])]),default:t(()=>[e(re,null,{default:t(()=>[e(we,null,{default:t(()=>[s("span",gl,l(a(c)("torrentDetail.peers.addPeers.title")),1)]),_:1}),e(ce,null,{default:t(()=>[e(Ye,null,{default:t(()=>[e(A,null,{default:t(()=>[e(T,{cols:"12"},{default:t(()=>[e(qe,{modelValue:f.value,"onUpdate:modelValue":m[0]||(m[0]=u=>f.value=u),label:a(c)("torrentDetail.peers.addPeers.newPeers"),placeholder:a(c)("torrentDetail.peers.addPeers.newPeersPlaceholder"),hint:a(c)("torrentDetail.peers.addPeers.newPeersHint")},null,8,["modelValue","label","placeholder","hint"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Pe,null,{default:t(()=>[e(J),e(U,{color:"error",onClick:S},{default:t(()=>[p(l(a(c)("common.cancel")),1)]),_:1}),e(U,{color:"accent",onClick:g},{default:t(()=>[p(l(a(c)("common.ok")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],2)]),_:1})]),_:1}))}}),yl=pe(hl,[["__scopeId","data-v-c673adc7"]]),kl=K({__name:"TagsAndCategories",props:{torrent:{},isActive:{type:Boolean}},setup(y){const d=y,c=me(),_=be(),C=R(()=>c.categories.map(f=>f.name).indexOf(d.torrent.category)),I=R(()=>c.tags.filter(f=>d.torrent.tags?.includes(f)));async function N(f){d.torrent.category===f?await _.setTorrentCategory([d.torrent.hash],""):await _.setTorrentCategory([d.torrent.hash],f)}async function v(f){d.torrent.tags?.includes(f)?await _.removeTorrentTags([d.torrent.hash],[f]):await _.addTorrentTags([d.torrent.hash],[f])}return ze(async()=>{await c.fetchCategories(),await c.fetchTags()}),(f,$)=>(r(),D(re,null,{default:t(()=>[e(ce,null,{default:t(()=>[e(A,null,{default:t(()=>[e(T,{cols:"12",md:"6"},{default:t(()=>[e(Re,{"model-value":I.value,multiple:""},{default:t(()=>[e(ie,null,{default:t(()=>[e(Ee,null,{default:t(()=>[p(l(f.$t("torrentDetail.tagsAndCategories.tags")),1)]),_:1}),(r(!0),h(F,null,E(a(c).tags,w=>(r(),D(H,{title:w,variant:f.torrent.tags?.includes(w)?"tonal":void 0,"base-color":f.torrent.tags?.includes(w)?"accent":void 0,onClick:b=>v(w)},null,8,["title","variant","base-color","onClick"]))),256))]),_:1})]),_:1},8,["model-value"])]),_:1}),e(T,{cols:"12",md:"6"},{default:t(()=>[e(Re,{"model-value":C.value},{default:t(()=>[e(ie,null,{default:t(()=>[e(Ee,null,{default:t(()=>[p(l(f.$t("torrentDetail.tagsAndCategories.categories")),1)]),_:1}),(r(!0),h(F,null,E(a(c).categories,w=>(r(),D(H,{title:w.name,variant:w.name===d.torrent.category?"tonal":void 0,"base-color":w.name===d.torrent.category?"accent":void 0,onClick:b=>N(w.name)},null,8,["title","variant","base-color","onClick"]))),256))]),_:1})]),_:1},8,["model-value"])]),_:1})]),_:1})]),_:1})]),_:1}))}}),wl={class:"d-flex"},Dl={key:0},bl={key:1},$l={key:2},Vl={key:3},Tl={key:0,class:"d-flex flex-column"},Cl={class:"text-h5"},Sl={class:"text-h5"},Nl=K({__name:"Trackers",props:{torrent:{},isActive:{type:Boolean}},setup(y){const d=y,{t:c}=_e(),_=me();function C(k){switch(k){case Y.DISABLED:return c("constants.trackerStatus.disabled");case Y.NOT_YET_CONTACTED:return c("constants.trackerStatus.not_yet_contacted");case Y.WORKING:return c("constants.trackerStatus.working");case Y.UPDATING:return c("constants.trackerStatus.updating");case Y.NOT_WORKING:return c("constants.trackerStatus.not_working");default:return""}}function I(k){return typeof k=="number"?k===-1?"N/A":k.valueOf():!k||k.num_peers===-1||k?.num_seeds===-1||k?.num_leeches===-1?"N/A":c("torrentDetail.trackers.peersValue",{peers:k.num_peers,seeds:k.num_seeds,leeches:k.num_leeches})}const N=O(!1),v=O([]),f=O(""),$=O(null),w=O(!1),b=[k=>!!k||c("torrentDetail.trackers.editTracker.newUrlRequired")],g=Nt({isVisible:!1,isFormValid:!1,oldUrl:"",newUrl:""});function S(k){g.isVisible=!0,g.oldUrl=k.url,g.newUrl=k.url,Ze(()=>{document.getElementById("input")?.select()})}async function V(){N.value=!0,v.value=(await _.getTorrentTrackers(d.torrent.hash)).map(k=>({...k,isSelectable:k.tier!==-1})),N.value=!1}async function i(){f.value.length&&(await _.addTorrentTrackers(d.torrent.hash,f.value),await V(),o())}function o(){w.value=!1,f.value=""}async function m(){g.isFormValid&&(await _.editTorrentTracker(d.torrent.hash,g.oldUrl,g.newUrl),g.isVisible=!1,await V())}async function u(k){await _.removeTorrentTrackers(d.torrent.hash,[k.url]),await V()}async function ee(){await _.reannounceTorrents([d.torrent.hash])}async function te(k){k??d.isActive?(await V(),$.value=setInterval(V,5e3)):(clearInterval($.value),$.value=null)}return ze(te),$e(()=>te(!1)),ve(()=>d.isActive,te),(k,x)=>(r(),D(ie,null,{default:t(()=>[(r(!0),h(F,null,E(v.value,(P,ge)=>(r(),h(F,null,[ge===3?(r(),D(Se,{key:0,color:"white",thickness:"5"})):ge>0?(r(),D(Se,{key:1,class:"mx-5",color:"white"})):B("",!0),e(H,null,{default:t(()=>[s("div",wl,[s("div",{class:fe(`tracker-${a(Y)[P.status].toLowerCase()}`)},[e(Ke,{class:"text-break text-wrap"},{default:t(()=>[p(l(P.url),1)]),_:2},1024),e(ke,{class:"d-block"},{default:t(()=>[P.msg?(r(),h("div",Dl,l(P.msg),1)):(r(),h("div",bl,l(C(P.status)),1)),P.tier>=0?(r(),h("div",$l,l(a(c)("torrentDetail.trackers.tier",P.tier)),1)):B("",!0),P.status!==a(Y).NOT_WORKING?(r(),h("div",Vl,[s("div",null,l(I(P)),1),s("div",null,"Downloads: "+l(I(P.num_downloaded)),1)])):B("",!0)]),_:2},1024)],2),e(J),P.tier>=0?(r(),h("div",Tl,[e(Ne,{modelValue:g.isVisible,"onUpdate:modelValue":x[4]||(x[4]=M=>g.isVisible=M),"max-width":"750px"},{activator:t(({props:M})=>[e(U,Ie(M,{icon:"mdi-pencil",variant:"text",onClick:Be=>S(P)}),null,16,["onClick"])]),default:t(()=>[e(re,null,{default:t(()=>[e(we,null,{default:t(()=>[s("span",Cl,l(a(c)("torrentDetail.trackers.editTracker.title")),1)]),_:1}),e(ce,null,{default:t(()=>[e(a(Dt),{modelValue:g.isFormValid,"onUpdate:modelValue":x[1]||(x[1]=M=>g.isFormValid=M),onSubmit:x[2]||(x[2]=Oe(()=>{},["prevent"]))},{default:t(()=>[e(a(We),{"model-value":g.oldUrl,disabled:"",label:k.$t("torrentDetail.trackers.editTracker.oldUrl")},null,8,["model-value","label"]),e(a(We),{modelValue:g.newUrl,"onUpdate:modelValue":x[0]||(x[0]=M=>g.newUrl=M),id:"input",rules:b,label:k.$t("torrentDetail.trackers.editTracker.newUrl"),autofocus:"",onKeydown:Pt(m,["enter"])},null,8,["modelValue","label"])]),_:1},8,["modelValue"])]),_:1}),e(Pe,null,{default:t(()=>[e(J),e(U,{color:"error",disabled:!g.isFormValid,onClick:x[3]||(x[3]=M=>g.isVisible=!1)},{default:t(()=>[p(l(a(c)("common.cancel")),1)]),_:1},8,["disabled"]),e(U,{color:"accent",onClick:m},{default:t(()=>[p(l(a(c)("common.ok")),1)]),_:1})]),_:1})]),_:1})]),_:2},1032,["modelValue"]),e(U,{color:"red",icon:"mdi-delete",variant:"text",onClick:M=>u(P)},null,8,["onClick"])])):B("",!0)])]),_:2},1024)],64))),256)),e(H,null,{default:t(()=>[s("div",{class:fe(["d-flex gap py-5",k.$vuetify.display.mobile?"flex-column":"justify-space-evenly"])},[e(Ne,{modelValue:w.value,"onUpdate:modelValue":x[6]||(x[6]=P=>w.value=P),"max-width":"750px"},{activator:t(({props:P})=>[e(U,Ie(P,{variant:"flat",text:a(c)("torrentDetail.trackers.addTrackers.title"),color:"accent"}),null,16,["text"])]),default:t(()=>[e(re,null,{default:t(()=>[e(we,null,{default:t(()=>[s("span",Sl,l(a(c)("torrentDetail.trackers.addTrackers.title")),1)]),_:1}),e(ce,null,{default:t(()=>[e(Ye,null,{default:t(()=>[e(A,null,{default:t(()=>[e(T,{cols:"12"},{default:t(()=>[e(qe,{modelValue:f.value,"onUpdate:modelValue":x[5]||(x[5]=P=>f.value=P),label:a(c)("torrentDetail.trackers.addTrackers.newTrackers"),hint:a(c)("torrentDetail.trackers.addTrackers.newTrackersHint")},null,8,["modelValue","label","hint"])]),_:1})]),_:1})]),_:1})]),_:1}),e(Pe,null,{default:t(()=>[e(J),e(U,{color:"error",onClick:o},{default:t(()=>[p(l(a(c)("common.cancel")),1)]),_:1}),e(U,{color:"accent",onClick:i},{default:t(()=>[p(l(a(c)("common.ok")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),e(U,{variant:"flat",disabled:v.value.length===3,text:a(c)("torrentDetail.trackers.reannounce"),color:"primary",onClick:ee},null,8,["disabled","text"])],2)]),_:1})]),_:1}))}}),Pl=pe(Nl,[["__scopeId","data-v-ed947913"]]),Ol={class:"pa-3 text-select"},Il={style:{"font-size":"1.6em !important"},class:"subtitle-1 ml-2"},Al={class:"d-flex justify-end"},Ll=K({__name:"TorrentDetail",setup(y){const d=Ot(),{t:c}=_e(),_=Ae(),C=He(),I=be(),N=[{text:c("torrentDetail.tabs.overview"),value:"overview"},{text:c("torrentDetail.tabs.info"),value:"info"},{text:c("torrentDetail.tabs.trackers"),value:"trackers"},{text:c("torrentDetail.tabs.peers"),value:"peers"},{text:c("torrentDetail.tabs.content"),value:"content"},{text:c("torrentDetail.tabs.tagsAndCategories"),value:"tagsAndCategories"}],v=O("overview"),f=R(()=>d.currentRoute.value.params.hash),$=R(()=>I.getTorrentByHash(f.value)),w=()=>{d.push({name:"dashboard"})};function b(S){if(C.hasActiveDialog)return!1;if(S.key==="Delete")return C.createDialog($t,{hashes:[f.value]}),S.preventDefault(),!0;S.key==="Escape"&&w()}function g(){const S=d.currentRoute.value.params.tab;S&&(v.value=S)}return It(()=>{g()}),xe(()=>{document.addEventListener("keydown",b),g()}),At(()=>{document.removeEventListener("keydown",b)}),(S,V)=>(r(),h(F,null,[s("div",Ol,[e(A,{"no-gutters":"",align:"center",justify:"center"},{default:t(()=>[e(T,null,{default:t(()=>[s("h1",Il,l(a(c)("torrentDetail.title")),1)]),_:1}),e(T,null,{default:t(()=>[s("div",Al,[e(U,{icon:"mdi-close",variant:"plain",onClick:w})])]),_:1})]),_:1}),e(A,{class:"ma-0 pa-0"},{default:t(()=>[e(Vt,{modelValue:v.value,"onUpdate:modelValue":V[0]||(V[0]=i=>v.value=i),"bg-color":"primary",grow:"","show-arrows":""},{default:t(()=>[(r(),h(F,null,E(N,({text:i,value:o})=>e(Tt,{value:o,href:`#/torrent/${f.value}/${o}`,text:i},null,8,["value","href","text"])),64))]),_:1},8,["modelValue"])]),_:1}),$.value?(r(),D(bt,{key:0,modelValue:v.value,"onUpdate:modelValue":V[1]||(V[1]=i=>v.value=i),touch:!1},{default:t(()=>[e(oe,{value:"overview"},{default:t(()=>[e(ul,{torrent:$.value,"is-active":v.value==="overview"},null,8,["torrent","is-active"])]),_:1}),e(oe,{value:"info"},{default:t(()=>[e(qt,{torrent:$.value,"is-active":v.value==="info"},null,8,["torrent","is-active"])]),_:1}),e(oe,{value:"trackers"},{default:t(()=>[e(Pl,{torrent:$.value,"is-active":v.value==="trackers"},null,8,["torrent","is-active"])]),_:1}),e(oe,{value:"peers"},{default:t(()=>[e(yl,{torrent:$.value,"is-active":v.value==="peers"},null,8,["torrent","is-active"])]),_:1}),e(oe,{value:"content"},{default:t(()=>[e(a(Gt),{torrent:$.value,"is-active":v.value==="content"},null,8,["torrent","is-active"])]),_:1}),e(oe,{value:"tagsAndCategories"},{default:t(()=>[e(kl,{torrent:$.value,"is-active":v.value==="tagsAndCategories"},null,8,["torrent","is-active"])]),_:1})]),_:1},8,["modelValue"])):B("",!0)]),s("div",{style:Xe(`position: absolute; left: ${a(_).rightClickProperties.offset[0]}px; top: ${a(_).rightClickProperties.offset[1]}px;`)},[e(a(nt),{modelValue:a(_).rightClickProperties.isVisible,"onUpdate:modelValue":V[2]||(V[2]=i=>a(_).rightClickProperties.isVisible=i),"menu-data":a(_).menuData},null,8,["modelValue","menu-data"])],4)],64))}});export{Ll as default};
