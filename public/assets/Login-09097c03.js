import{A as v,_ as b,a6 as q,d as x,r as C,h,$ as k,a0 as S,a1 as s,D as e,V as c,Z as p,u as l,Y as f,ag as _}from"./vue-aae79161.js";import{_ as K}from"./PasswordField.vue_vue_type_script_setup_true_lang-65fbb4af.js";import{s as A,aQ as T,aR as B,i as F,aK as R,j as U,t as D,v as I,m as L,w as M,x as N,k as O,ag as y}from"./index-89698a51.js";const Z=v({__name:"Login",setup($){const{t:a}=A(),V=b(),o=q(),u=T(),r=x({username:"",password:""}),m=C(!1),w={username:[i=>!!i||a("login.rules.username_required")],password:[i=>!!i||a("login.rules.password_required")]},d=async()=>{m.value&&(await u.login(r.username,r.password),u.isAuthenticated?(y.success(a("login.success")),g()):y.error(a("login.error")))},g=()=>{o.query.redirect?V.push(o.query.redirect):V.push({name:"dashboard"})};return h(async()=>{o.query.username&&o.query.password&&await u.login(o.query.username,o.query.password),u.isAuthenticated&&g()}),(i,t)=>(k(),S(B,{class:"mt-16"},{default:s(()=>[e(O,{class:"mx-auto",rounded:"lg","min-width":"250"},{default:s(()=>[e(F,null,{default:s(()=>[c(p(l(a)("login.title")),1)]),_:1}),e(R,null,{default:s(()=>[c(p(l(a)("login.subtitle")),1)]),_:1}),e(U,null,{default:s(()=>[e(D,{modelValue:m.value,"onUpdate:modelValue":t[2]||(t[2]=n=>m.value=n),onSubmit:f(d,["prevent"])},{default:s(()=>[e(I,{modelValue:r.username,"onUpdate:modelValue":t[0]||(t[0]=n=>r.username=n),label:l(a)("login.username"),autofocus:"",rules:w.username,onKeydown:_(f(d,["prevent"]),["enter"]),variant:"outlined"},{prepend:s(()=>[e(L,{color:"accent",icon:"mdi-account"})]),_:1},8,["modelValue","label","rules","onKeydown"]),e(K,{modelValue:r.password,"onUpdate:modelValue":t[1]||(t[1]=n=>r.password=n),label:l(a)("login.password"),rules:w.password,"prepend-icon":"mdi-lock",onKeydown:_(f(d,["prevent"]),["enter"]),variant:"outlined"},null,8,["modelValue","label","rules","onKeydown"])]),_:1},8,["modelValue","onSubmit"])]),_:1}),e(M,null,{default:s(()=>[e(N,{variant:"elevated",block:"",color:"accent",onClick:d},{default:s(()=>[c(p(l(a)("login.submit")),1)]),_:1})]),_:1})]),_:1})]),_:1}))}});export{Z as default};
