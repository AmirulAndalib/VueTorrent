import{g as L,a1 as d,a5 as S,aa as m,Z as c,W as I,c as C,a2 as B,a3 as a,F as Z,a6 as oe,u as s,m as t,S as ot,n as F,a4 as je,ad as lt,a7 as H,ae as Ye,af as Xe,K as Pe,d as E,r as We,M as ve,x as Je,Y as q,an as me,D as ae,$ as Ze,ao as nt,ap as st,a0 as Fe,w as rt,q as it,aq as dt,A as Oe,N as we,P as xe}from"./vue-82d20804.js";import{V as Ke,_ as Le,u as le,f as ut,a as ct,T as M,b as mt,c as pt,d as vt,e as ht,g as pe,h as Qe,i as he,j as G,k as Ce,D as R,l as Se,m as _e,n as et,o as Ee,p as te,q as Ae,r as ne,s as Ue,t as j,v as Me,w as A,x as Re,y as fe,z as _t,A as Be,B as Ie,C as ce,E as De,F as tt,G as ft,H as z,I as at,J as He,K as bt,L as gt,M as ze}from"./index-7f69d4f1.js";import{_ as qe}from"./MoveTorrentDialog.vue_vue_type_script_setup_true_lang-fef1a09d.js";import{d as Ne}from"./dayjs.min-f0b61d8a.js";import"./faker-c43f92d4.js";import{u as yt}from"./ArrayPagination-ae51d111.js";import{d as kt}from"./index-0f2c1715.js";import{ac as Tt}from"./vuetify-3844e172.js";const Vt={class:"d-flex flex-column"},$t={class:"text-caption text-grey"},wt={class:"text-caption text-grey"},xt=L({__name:"ItemAmount",props:{torrent:{},title:{},value:{},total:{}},setup($){return(e,o)=>(d(),S("div",Vt,[m("div",$t,c(e.$t(`torrent.properties.${e.title}`)),1),m("div",null,[I(c(e.torrent[e.value])+" ",1),m("span",wt," / "+c(e.torrent[e.total]),1)])]))}}),St={class:"d-flex flex-column"},Bt={class:"text-caption text-grey"},Dt={class:"d-flex flex-row gap"},Ct=L({__name:"ItemChip",props:{torrent:{},title:{},value:{},color:{}},setup($){const e=$,o=C(()=>{const i=e.torrent[e.value],n=typeof i;if(n==="string")return i.length>0?[i]:[];if(n==="object")return i});return(i,n)=>(d(),S("div",St,[m("div",Bt,c(i.$t(`torrent.properties.${i.title}`)),1),m("div",Dt,[!o.value||o.value.length<1?(d(),B(Ke,{key:0,color:i.color.replace("$1",i.torrent[i.value]),variant:"flat"},{default:a(()=>[I(c(i.$t(`torrent.properties.empty_${i.value}`)),1)]),_:1},8,["color"])):(d(!0),S(Z,{key:1},oe(o.value,g=>(d(),B(Ke,{color:i.color.replace("$1",i.torrent.state),variant:"flat"},{default:a(()=>[I(c(g),1)]),_:2},1032,["color"]))),256))])]))}});const It=Le(Ct,[["__scopeId","data-v-8eb4906a"]]),Pt={class:"d-flex flex-column"},Lt={class:"text-caption text-grey"},Et={class:"text-caption text-grey"},At=L({__name:"ItemData",props:{torrent:{},title:{},value:{}},setup($){const e=le();return(o,i)=>(d(),S("div",Pt,[m("div",Lt,c(o.$t(`torrent.properties.${o.title}`)),1),m("div",null,[I(c(s(ut)(o.torrent[o.value],s(e).useBinarySize))+" ",1),m("span",Et,c(s(ct)(o.torrent[o.value],s(e).useBinarySize)),1)])]))}}),Ut={class:"d-flex flex-column"},Mt={class:"text-caption text-grey"},Rt={key:0},Nt={key:1},Ft=L({__name:"ItemDateTime",props:{torrent:{},title:{},value:{}},setup($){const e=le();return(o,i)=>(d(),S("div",Ut,[m("div",Mt,c(o.$t(`torrent.properties.${o.title}`)),1),m("div",null,[o.torrent[o.value]>0?(d(),S("span",Rt,c(s(Ne)(o.torrent[o.value]*1e3).format(s(e).dateFormat??"DD/MM/YYYY, HH:mm:ss")),1)):(d(),S("span",Nt,c(o.$t("dashboard.not_complete")),1))])]))}}),Ot={class:"d-flex flex-column"},Kt={class:"text-caption text-grey"},Ht={key:0},zt={key:1},qt="D[d] H[h] m[m] s[s]",Gt=L({__name:"ItemDuration",props:{torrent:{},title:{},value:{}},setup($){return(e,o)=>(d(),S("div",Ot,[m("div",Kt,c(e.$t(`torrent.properties.${e.title}`)),1),m("div",null,[e.torrent[e.value]>0?(d(),S("span",Ht,c(s(Ne).duration(e.torrent[e.value],"seconds").format(qt)),1)):(d(),S("span",zt,c(e.$t("dashboard.not_complete")),1))])]))}}),jt={class:"d-flex flex-column"},Yt={class:"text-caption text-grey"},Xt=L({__name:"ItemPercent",props:{torrent:{},title:{},value:{}},setup($){const e=$,o=C(()=>[M.UPLOADING,M.CHECKING_UP,M.FORCED_UP,M.ALLOCATING,M.DOWNLOADING,M.META_DL,M.CHECKING_DL,M.FORCED_DL,M.CHECKING_RESUME_DATA,M.MOVING].includes(e.torrent.state));return(i,n)=>(d(),S("div",jt,[m("div",Yt,c(i.$t(`torrent.properties.${i.title}`)),1),t(pt,{"model-value":i.torrent[i.value],max:1,striped:o.value,height:20,color:`torrent-${i.torrent.state}`,rounded:"sm",style:{width:"10em"}},{default:a(()=>[I(c(s(mt)(i.torrent[i.value])),1)]),_:1},8,["model-value","striped","color"])]))}}),Wt={class:"d-flex flex-column"},Jt={class:"text-caption text-grey"},Zt=L({__name:"ItemRelativeTime",props:{torrent:{},title:{},value:{}},setup($){return(e,o)=>(d(),S("div",Wt,[m("div",Jt,c(e.$t(`torrent.properties.${e.title}`)),1),m("div",null,[m("span",null,c(s(Ne)(e.torrent[e.value]*1e3).fromNow()),1)])]))}}),Qt={class:"d-flex flex-column"},ea={class:"text-caption text-grey"},ta={class:"text-caption text-grey"},aa=L({__name:"ItemSpeed",props:{torrent:{},title:{},value:{}},setup($){const e=le();return(o,i)=>(d(),S("div",Qt,[m("div",ea,c(o.$t(`torrent.properties.${o.title}`)),1),m("div",null,[I(c(s(vt)(o.torrent[o.value],s(e).useBitSpeed))+" ",1),m("span",ta,c(s(ht)(o.torrent[o.value],s(e).useBitSpeed)),1)])]))}}),oa={class:"d-flex flex-column"},la={class:"text-caption text-grey"},na=L({__name:"ItemText",props:{torrent:{},title:{},value:{}},setup($){return(e,o)=>(d(),S("div",oa,[m("div",la,c(e.$t(`torrent.properties.${e.title}`)),1),m("div",null,c(e.torrent[e.value]),1)]))}}),sa={class:"d-flex gap flex-wrap"},ra=L({__name:"Torrent",props:{torrent:{}},setup($){const e=$,o=pe(),i=le(),n=C(()=>(e.torrent.progress===1?i.doneTorrentProperties:i.busyTorrentProperties).filter(f=>f.active).sort((f,u)=>f.order-u.order));function g(r){r.shiftKey?o.spanTorrentSelection(e.torrent.hash):(Ce(r)||o.isSelectionMultiple)&&(o.isSelectionMultiple=!0,o.toggleSelect(e.torrent.hash))}const _=r=>{switch(r){case R.AMOUNT:return xt;case R.CHIP:return It;case R.DATA:return At;case R.DATETIME:return Ft;case R.DURATION:return Gt;case R.PERCENT:return Xt;case R.RELATIVE:return Zt;case R.SPEED:return aa;case R.TEXT:default:return na}},k=C(()=>o.isTorrentInSelection(e.torrent.hash));return(r,f)=>(d(),B(G,{class:je(`sideborder ${r.torrent.state} pointer`),color:k.value?`torrent-${r.torrent.state}-darken-3`:void 0,width:"100%",onClick:g},{default:a(()=>[t(Qe,{class:"text-wrap text-subtitle-1 pt-1 pb-0"},{default:a(()=>[I(c(r.torrent.name),1)]),_:1}),t(he,{class:"pa-2 pt-0"},{default:a(()=>[m("div",sa,[(d(!0),S(Z,null,oe(n.value,u=>(d(),B(ot(_(u.type)),F({torrent:r.torrent},u.props),null,16,["torrent"]))),256))])]),_:1})]),_:1},8,["class","color"]))}});const ia=Le(ra,[["__scopeId","data-v-2203dbac"]]),da={class:"d-flex"},ua={key:2},ca={key:3},ma=L({__name:"RightClickMenuEntry",props:{text:{},icon:{},action:{type:Function},hidden:{type:Boolean},disabled:{type:Boolean},disabledText:{},disabledIcon:{},divider:{type:Boolean},children:{}},setup($){return(e,o)=>{const i=lt("RightClickMenuEntry",!0);return e.hidden?H("",!0):(d(),B(te,{key:0,class:"px-3 pointer",disabled:e.disabled,onClick:e.action},{default:a(()=>[m("div",da,[e.disabled&&e.disabledIcon?(d(),B(Se,{key:0,class:"mr-2"},{default:a(()=>[I(c(e.disabledIcon),1)]),_:1})):e.icon?(d(),B(Se,{key:1,class:"mr-2"},{default:a(()=>[I(c(e.icon),1)]),_:1})):H("",!0),e.disabled&&e.disabledText?(d(),S("span",ua,c(e.disabledText),1)):(d(),S("span",ca,c(e.text),1)),t(_e),!e.disabled&&e.children?(d(),B(Se,{key:4},{default:a(()=>[I("mdi-chevron-right")]),_:1})):H("",!0)]),e.children?(d(),B(et,{key:0,activator:"parent","open-on-hover":!0,"open-on-click":!0,"close-delay":"0","open-delay":"0",location:"right"},{default:a(()=>[t(Ee,null,{default:a(()=>[(d(!0),S(Z,null,oe(e.children,n=>(d(),B(i,Ye(Xe(n)),null,16))),256))]),_:1})]),_:1})):H("",!0)]),_:1},8,["disabled","onClick"]))}}}),pa=L({__name:"RenameTorrentDialog",props:{guid:{},hash:{}},setup($){const e=$,{isOpened:o}=Ae(e.guid),{t:i}=Pe(),n=ne(),g=E(),_=E(),k=E(!1),r=We({newName:""}),f=[w=>!!w||i("dialogs.renameTorrent.required"),w=>w!==T.value||i("dialogs.renameTorrent.sameName")],u=C(()=>n.getTorrentByHash(e.hash)),T=C(()=>u.value?.name);async function D(){await _.value?.validate(),k.value&&(await n.renameTorrent(e.hash,r.newName),v())}const v=()=>{o.value=!1};return ve(()=>{r.newName=u.value?.name||""}),Je(()=>{g.value?.select()}),(w,x)=>(d(),B(Re,{modelValue:s(o),"onUpdate:modelValue":x[3]||(x[3]=b=>ae(o)?o.value=b:null)},{default:a(()=>[t(G,null,{default:a(()=>[t(Qe,null,{default:a(()=>[I(c(w.$t("dialogs.renameTorrent.title")),1)]),_:1}),t(he,null,{default:a(()=>[t(s(Ue),{modelValue:k.value,"onUpdate:modelValue":x[1]||(x[1]=b=>k.value=b),ref_key:"form",ref:_,onSubmit:x[2]||(x[2]=q(()=>{},["prevent"]))},{default:a(()=>[T.value?(d(),B(j,{key:0,"model-value":T.value,disabled:"",label:w.$t("dialogs.renameTorrent.oldName")},null,8,["model-value","label"])):H("",!0),t(j,{modelValue:r.newName,"onUpdate:modelValue":x[0]||(x[0]=b=>r.newName=b),ref_key:"field",ref:g,rules:f,autofocus:"",label:w.$t("dialogs.renameTorrent.newName"),onKeydown:me(D,["enter"])},null,8,["modelValue","label","onKeydown"])]),_:1},8,["modelValue"])]),_:1}),t(Me,null,{default:a(()=>[t(_e),t(A,{color:"error",onClick:v},{default:a(()=>[I(c(w.$t("common.cancel")),1)]),_:1}),t(A,{color:"accent",disabled:!k.value,onClick:D},{default:a(()=>[I(c(w.$t("common.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1})]),_:1},8,["modelValue"]))}}),J=-2,N=-1,va=L({__name:"ShareLimitDialog",props:{guid:{},hashes:{}},setup($){const e=$,{isOpened:o}=Ae(e.guid),i=fe(),n=ne(),g=E(!1),_=E("global"),k=E(!1),r=E(0),f=E(!1),u=E(0),T=E(!1),D=E(0),v=C(()=>_.value!=="enabled");function w(){o.value=!1}async function x(){switch(_.value){case"global":await i.setShareLimit(e.hashes,J,J,J);break;case"disabled":await i.setShareLimit(e.hashes,N,N,N);break;case"enabled":await i.setShareLimit(e.hashes,k.value?r.value:N,f.value?u.value:N,T.value?D.value:N);break}w()}return ve(async()=>{const b=n.getTorrentByHash(e.hashes[0]);if(!b)return w();const p=b.ratio_limit,V=b.seeding_time_limit,O=b.inactive_seeding_time_limit;p===J&&V===J&&O===J?_.value="global":p===N&&V===N&&O===N?_.value="disabled":(_.value="enabled",k.value=p>=0,r.value=k.value?p:0,f.value=V>=0,u.value=f.value?V:0,T.value=O>=0,D.value=T.value?O:0)}),(b,p)=>(d(),B(Re,{modelValue:s(o),"onUpdate:modelValue":p[9]||(p[9]=V=>ae(o)?o.value=V:null),"max-width":"500"},{default:a(()=>[t(G,{title:b.$t("dialogs.share_limit.title")},{default:a(()=>[t(he,null,{default:a(()=>[t(Ue,{modelValue:g.value,"onUpdate:modelValue":p[7]||(p[7]=V=>g.value=V),onSubmit:p[8]||(p[8]=q(()=>{},["prevent"])),onKeydown:me(q(x,["prevent"]),["enter"])},{default:a(()=>[t(_t,{modelValue:_.value,"onUpdate:modelValue":p[0]||(p[0]=V=>_.value=V)},{default:a(()=>[t(Be,{label:b.$t("dialogs.share_limit.global"),value:"global"},null,8,["label"]),t(Be,{label:b.$t("dialogs.share_limit.disabled"),value:"disabled"},null,8,["label"]),t(Be,{label:b.$t("dialogs.share_limit.enabled"),value:"enabled"},null,8,["label"])]),_:1},8,["modelValue"]),t(Ie,null,{default:a(()=>[t(ce,{cols:"12",class:"d-flex align-center"},{default:a(()=>[m("span",null,[t(De,{modelValue:k.value,"onUpdate:modelValue":p[1]||(p[1]=V=>k.value=V),disabled:v.value},null,8,["modelValue","disabled"])]),t(j,{modelValue:r.value,"onUpdate:modelValue":p[2]||(p[2]=V=>r.value=V),disabled:v.value||!k.value,density:"compact","hide-details":"",label:b.$t("dialogs.share_limit.ratio_limit")},null,8,["modelValue","disabled","label"])]),_:1}),t(ce,{cols:"12",class:"d-flex align-center"},{default:a(()=>[m("span",null,[t(De,{modelValue:f.value,"onUpdate:modelValue":p[3]||(p[3]=V=>f.value=V),disabled:v.value},null,8,["modelValue","disabled"])]),t(j,{modelValue:u.value,"onUpdate:modelValue":p[4]||(p[4]=V=>u.value=V),disabled:v.value||!f.value,density:"compact","hide-details":"",label:b.$t("dialogs.share_limit.seeding_time_limit")},null,8,["modelValue","disabled","label"])]),_:1}),t(ce,{cols:"12",class:"d-flex align-center"},{default:a(()=>[m("span",null,[t(De,{modelValue:T.value,"onUpdate:modelValue":p[5]||(p[5]=V=>T.value=V),disabled:v.value},null,8,["modelValue","disabled"])]),t(j,{modelValue:D.value,"onUpdate:modelValue":p[6]||(p[6]=V=>D.value=V),disabled:v.value||!T.value,density:"compact","hide-details":"",label:b.$t("dialogs.share_limit.inactive_seeding_time_limit")},null,8,["modelValue","disabled","label"])]),_:1})]),_:1})]),_:1},8,["modelValue","onKeydown"])]),_:1}),t(Me,null,{default:a(()=>[t(_e),t(A,{color:"error",onClick:w},{default:a(()=>[I(c(b.$t("common.cancel")),1)]),_:1}),t(A,{color:"accent",disabled:!g.value,onClick:x},{default:a(()=>[I(c(b.$t("common.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"]))}}),Ge=L({__name:"SpeedLimitDialog",props:{guid:{},hashes:{},mode:{}},setup($){const e=$,{isOpened:o}=Ae(e.guid),i=fe(),n=ne(),g=E(!1),_=E(0);function k(){o.value=!1}async function r(){const f=Math.max(0,_.value)*1e3;switch(e.mode){case"download":await i.setDownloadLimit(f,e.hashes);break;case"upload":await i.setUploadLimit(f,e.hashes);break}k()}return ve(async()=>{const f=n.getTorrentByHash(e.hashes[0]);if(!f)return k();switch(e.mode){case"download":_.value=Math.max(0,Math.round(f.dl_limit/1e3));break;case"upload":_.value=Math.max(0,Math.round(f.up_limit/1e3));break}}),(f,u)=>(d(),B(Re,{modelValue:s(o),"onUpdate:modelValue":u[3]||(u[3]=T=>ae(o)?o.value=T:null)},{default:a(()=>[t(G,{title:f.$t(`dialogs.speed_limit.${f.mode}`)},{default:a(()=>[t(he,null,{default:a(()=>[t(Ue,{modelValue:g.value,"onUpdate:modelValue":u[1]||(u[1]=T=>g.value=T),onSubmit:u[2]||(u[2]=q(()=>{},["prevent"])),onKeydown:me(q(r,["prevent"]),["enter"])},{default:a(()=>[t(j,{modelValue:_.value,"onUpdate:modelValue":u[0]||(u[0]=T=>_.value=T),type:"number",autofocus:"",clearable:"",label:f.$t("dialogs.speed_limit.label"),"prepend-inner-icon":"mdi-speedometer",suffix:"kB/s",onKeydown:me(q(r,["prevent"]),["enter"])},null,8,["modelValue","label","onKeydown"])]),_:1},8,["modelValue","onKeydown"])]),_:1}),t(Me,null,{default:a(()=>[t(_e),t(A,{color:"error",onClick:k},{default:a(()=>[I(c(f.$t("common.cancel")),1)]),_:1}),t(A,{color:"accent",disabled:!g.value,onClick:r},{default:a(()=>[I(c(f.$t("common.save")),1)]),_:1},8,["disabled"])]),_:1})]),_:1},8,["title"])]),_:1},8,["modelValue"]))}}),be=$=>(nt("data-v-150ffd25"),$=$(),st(),$),ha={class:"d-flex justify-space-around"},_a=be(()=>m("span",null,"Resume",-1)),fa=be(()=>m("span",null,"Force Resume",-1)),ba=be(()=>m("span",null,"Pause",-1)),ga=be(()=>m("span",null,"Delete",-1)),ya=L({__name:"RightClickMenu",props:{modelValue:{type:Boolean}},emits:["update:modelValue"],setup($,{emit:e}){const o=$,i=e,{t:n}=Pe(),g=Ze(),_=pe(),k=tt(),r=fe(),f=ft(),u=ne(),T=C({get:()=>o.modelValue,set:l=>i("update:modelValue",l)}),D=C(()=>_.selectedTorrents.length>1),v=C(()=>_.selectedTorrents),w=C(()=>v.value[0]),x=C(()=>u.getTorrentByHash(w.value)),b=C(()=>_.selectedTorrents.map(u.getTorrentByHash).filter(l=>!!l)),p=C(()=>[{name:""},...r.categories]);async function V(){await u.resumeTorrents(v)}async function O(){await u.forceResumeTorrents(v)}async function K(){await u.pauseTorrents(v)}function se(){k.createDialog(at,{hashes:[..._.selectedTorrents]})}function ge(){k.createDialog(qe,{hashes:[..._.selectedTorrents],mode:"dl"})}function re(){k.createDialog(qe,{hashes:[..._.selectedTorrents],mode:"save"})}function Y(){k.createDialog(pa,{hash:_.selectedTorrents[0]})}async function ye(){await u.recheckTorrents(v)}async function ke(){await r.reannounceTorrents(v)}async function Te(){await r.toggleSeqDl(v)}async function Q(){await r.toggleFLPiecePrio(v)}async function Ve(){await r.toggleAutoTmm(v,!x.value?.auto_tmm)}function ie(l){return b.value.every(P=>P&&P.tags&&P.tags.includes(l))}async function de(l){ie(l)?await u.removeTorrentTags(v.value,[l]):await u.addTorrentTags(v.value,[l])}async function X(l){await navigator.clipboard.writeText(l)}function ue(){k.createDialog(Ge,{hashes:v.value,mode:"download"})}function $e(){k.createDialog(Ge,{hashes:v.value,mode:"upload"})}function ee(){k.createDialog(va,{hashes:v.value})}async function h(){v.value.forEach(l=>{u.exportTorrent(l).then(P=>{const U=window.URL.createObjectURL(P),W=document.createElement("a");W.href=U,W.style.opacity="0",W.setAttribute("download",`${l}.torrent`),document.body.appendChild(W),W.click(),document.body.removeChild(W)})})}const y=C(()=>[{text:n("dashboard.right_click.advanced.title"),icon:"mdi-head-cog",children:[{text:n("dashboard.right_click.advanced.download_path"),icon:"mdi-tray-arrow-down",action:ge},{text:n("dashboard.right_click.advanced.save_path"),icon:"mdi-content-save",action:re},{text:n("dashboard.right_click.advanced.rename"),icon:"mdi-rename-box",hidden:D.value,action:Y},{text:n("dashboard.right_click.advanced.recheck"),icon:"mdi-playlist-check",action:ye},{text:n("dashboard.right_click.advanced.reannounce"),icon:"mdi-bullhorn",action:ke},{text:n("dashboard.right_click.advanced.seq_dl"),icon:x.value?.seq_dl?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",action:Te},{text:n("dashboard.right_click.advanced.f_l_prio"),icon:x.value?.f_l_piece_prio?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",action:Q},{text:n("dashboard.right_click.advanced.auto_tmm"),icon:x.value?.auto_tmm?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",action:Ve}]},{text:n("dashboard.right_click.priority.title"),icon:"mdi-priority-high",hidden:!f.preferences.queueing_enabled,children:[{text:n("dashboard.right_click.priority.top"),icon:"mdi-priority-high",action:async()=>await u.setTorrentPriority(v.value,"topPrio")},{text:n("dashboard.right_click.priority.increase"),icon:"mdi-arrow-up",action:async()=>await u.setTorrentPriority(v.value,"increasePrio")},{text:n("dashboard.right_click.priority.decrease"),icon:"mdi-arrow-down",action:async()=>await u.setTorrentPriority(v.value,"decreasePrio")},{text:n("dashboard.right_click.priority.bottom"),icon:"mdi-priority-low",action:async()=>await u.setTorrentPriority(v.value,"bottomPrio")}]},{text:n("dashboard.right_click.tags.title"),icon:"mdi-tag",disabled:r.tags.length===0,disabledText:n("dashboard.right_click.tags.disabled_title"),disabledIcon:"mdi-tag-off",children:r.tags.map(l=>({text:l,icon:ie(l)?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",action:async()=>await de(l)}))},{text:n("dashboard.right_click.category.title"),icon:"mdi-label",disabled:r.categories.length===0,disabledText:n("dashboard.right_click.category.disabled_title"),disabledIcon:"mdi-label-off",children:p.value.map(l=>({text:l.name===""?n("dashboard.right_click.category.clear"):l.name,action:async()=>await u.setTorrentCategory(v.value,l.name)}))},{text:n("dashboard.right_click.speed_limit.title"),icon:"mdi-speedometer-slow",children:[{text:n("dashboard.right_click.speed_limit.download"),icon:"mdi-download",action:ue},{text:n("dashboard.right_click.speed_limit.upload"),icon:"mdi-upload",action:$e},{text:n("dashboard.right_click.speed_limit.share"),icon:"mdi-account-group",action:ee}]},{text:n("dashboard.right_click.copy.title"),icon:"mdi-content-copy",hidden:D.value,children:[{text:n("dashboard.right_click.copy.name"),icon:"mdi-alphabetical-variant",action:async()=>x.value&&await X(x.value.name)},{text:n("dashboard.right_click.copy.hash"),icon:"mdi-pound",action:async()=>await X(w.value)},{text:n("dashboard.right_click.copy.magnet"),icon:"mdi-magnet",action:async()=>x.value&&await X(x.value.magnet)}]},{text:n("dashboard.right_click.export",_.selectedTorrents.length),icon:D.value?"mdi-download-multiple":"mdi-download",action:h},{text:n("dashboard.right_click.info"),icon:"mdi-information",hidden:D.value,action:()=>g.push({name:"torrentDetail",params:{hash:w.value}})}]);return(l,P)=>T.value?(d(),B(et,{key:0,modelValue:T.value,"onUpdate:modelValue":P[0]||(P[0]=U=>T.value=U),activator:"parent","close-on-content-click":!0,transition:"slide-y-transition","scroll-strategy":"none"},{default:a(()=>[t(Ee,null,{default:a(()=>[t(te,null,{default:a(()=>[m("div",ha,[t(z,{location:"top"},{activator:a(({props:U})=>[t(A,F({density:"compact",variant:"plain",icon:"mdi-play"},U,{onClick:V}),null,16)]),default:a(()=>[_a]),_:1}),t(z,{location:"top"},{activator:a(({props:U})=>[t(A,F({density:"compact",variant:"plain",icon:"mdi-fast-forward"},U,{onClick:O}),null,16)]),default:a(()=>[fa]),_:1}),t(z,{location:"top"},{activator:a(({props:U})=>[t(A,F({density:"compact",variant:"plain",icon:"mdi-pause"},U,{onClick:K}),null,16)]),default:a(()=>[ba]),_:1}),t(z,{location:"top"},{activator:a(({props:U})=>[t(A,F({color:"red",density:"compact",variant:"plain",icon:"mdi-delete-forever"},U,{onClick:se}),null,16)]),default:a(()=>[ga]),_:1})])]),_:1}),(d(!0),S(Z,null,oe(y.value,U=>(d(),B(ma,Ye(Xe(U)),null,16))),256))]),_:1})]),_:1},8,["modelValue"])):H("",!0)}});const ka=Le(ya,[["__scopeId","data-v-150ffd25"]]),Ta={class:"pt-4 px-1 px-sm-5"},Va={class:"pa-0",style:{width:"10em"}},$a={class:"text-uppercase",style:{float:"right","font-size":"0.8em"}},wa={class:"text-grey"},xa={key:0,class:"mt-5 text-xs-center"},Sa={class:"text-grey"},Ba={key:1},Da={class:"d-flex align-center"},Ra=L({__name:"Dashboard",setup($){const{t:e}=Pe(),o=Ze(),i=Tt(),{currentPage:n,isSelectionMultiple:g,selectedTorrents:_,torrentCountString:k}=Fe(pe()),r=pe(),f=tt(),u=fe(),T=ne(),{filteredTorrents:D,sortOptions:v}=Fe(T),w=le(),x=[{value:"added_on",title:e("dashboard.sortBy.added_on")},{value:"amount_left",title:e("dashboard.sortBy.amount_left")},{value:"auto_tmm",title:e("dashboard.sortBy.auto_tmm")},{value:"availability",title:e("dashboard.sortBy.availability")},{value:"avg_download_speed",title:e("dashboard.sortBy.avg_download_speed")},{value:"avg_upload_speed",title:e("dashboard.sortBy.avg_upload_speed")},{value:"category",title:e("dashboard.sortBy.category")},{value:"completed",title:e("dashboard.sortBy.completed")},{value:"completion_on",title:e("dashboard.sortBy.completion_on")},{value:"content_path",title:e("dashboard.sortBy.content_path")},{value:"dl_limit",title:e("dashboard.sortBy.dl_limit")},{value:"dlspeed",title:e("dashboard.sortBy.dlspeed")},{value:"download_path",title:e("dashboard.sortBy.download_path")},{value:"downloaded",title:e("dashboard.sortBy.downloaded")},{value:"downloaded_session",title:e("dashboard.sortBy.downloaded_session")},{value:"eta",title:e("dashboard.sortBy.eta")},{value:"f_l_piece_prio",title:e("dashboard.sortBy.f_l_piece_prio")},{value:"force_start",title:e("dashboard.sortBy.force_start")},{value:"globalSpeed",title:e("dashboard.sortBy.globalSpeed")},{value:"globalVolume",title:e("dashboard.sortBy.globalVolume")},{value:"hash",title:e("dashboard.sortBy.hash")},{value:"infohash_v1",title:e("dashboard.sortBy.infohash_v1")},{value:"infohash_v2",title:e("dashboard.sortBy.infohash_v2")},{value:"last_activity",title:e("dashboard.sortBy.last_activity")},{value:"magnet_uri",title:e("dashboard.sortBy.magnet_uri")},{value:"max_ratio",title:e("dashboard.sortBy.max_ratio")},{value:"max_seeding_time",title:e("dashboard.sortBy.max_seeding_time")},{value:"name",title:e("dashboard.sortBy.name")},{value:"num_complete",title:e("dashboard.sortBy.num_complete")},{value:"num_incomplete",title:e("dashboard.sortBy.num_incomplete")},{value:"num_leechs",title:e("dashboard.sortBy.num_leechs")},{value:"num_seeds",title:e("dashboard.sortBy.num_seeds")},{value:"priority",title:e("dashboard.sortBy.priority")},{value:"progress",title:e("dashboard.sortBy.progress")},{value:"ratio",title:e("dashboard.sortBy.ratio")},{value:"ratio_limit",title:e("dashboard.sortBy.ratio_limit")},{value:"save_path",title:e("dashboard.sortBy.save_path")},{value:"seeding_time",title:e("dashboard.sortBy.seeding_time")},{value:"seeding_time_limit",title:e("dashboard.sortBy.seeding_time_limit")},{value:"seen_complete",title:e("dashboard.sortBy.seen_complete")},{value:"seq_dl",title:e("dashboard.sortBy.seq_dl")},{value:"size",title:e("dashboard.sortBy.size")},{value:"state",title:e("dashboard.sortBy.state")},{value:"super_seeding",title:e("dashboard.sortBy.super_seeding")},{value:"tags",title:e("dashboard.sortBy.tags")},{value:"time_active",title:e("dashboard.sortBy.time_active")},{value:"total_size",title:e("dashboard.sortBy.total_size")},{value:"tracker",title:e("dashboard.sortBy.tracker")},{value:"trackers_count",title:e("dashboard.sortBy.trackers_count")},{value:"up_limit",title:e("dashboard.sortBy.up_limit")},{value:"uploaded",title:e("dashboard.sortBy.uploaded")},{value:"uploaded_session",title:e("dashboard.sortBy.uploaded_session")},{value:"upspeed",title:e("dashboard.sortBy.upspeed")}].sort((h,y)=>h.title.localeCompare(y.title));x.splice(0,0,{value:"",title:e("dashboard.sortBy.default")});const b=E(!1),p=We({isVisible:!1,offset:[0,0]}),V=C({get:()=>T.textFilter,set:kt(h=>{T.textFilter=h??""},300)}),{paginatedResults:O,currentPage:K,pageCount:se}=yt(D,w.paginationSize,n),ge=C(()=>!!T.textFilter&&T.textFilter.length>0),re=C(()=>D.value.length<=_.value.length);function Y(h){b.value=h??!b.value,b.value&&Oe(()=>{document.getElementById("searchInput")?.focus()})}function ye(h){r.toggleSelect(h)}function ke(h){g.value||o.push({name:"torrentDetail",params:{hash:h}})}function Te(){T.textFilter=""}function Q(){window.scrollTo({top:0,behavior:"smooth"})}function Ve(){g.value&&r.unselectAllTorrents(),g.value=!g.value}function ie(){re.value?r.unselectAllTorrents():r.selectTorrents(...D.value.map(h=>h.hash))}async function de(h,y){h.preventDefault(),p.isVisible&&(p.isVisible=!1,await Oe()),p.isVisible=!0,p.offset=[h.pageX,h.pageY],g.value?_.value.length===0&&r.selectTorrent(y.hash):(r.unselectAllTorrents(),r.selectTorrent(y.hash))}rt(()=>p.isVisible,h=>{!h&&!g.value&&r.unselectAllTorrents()});function X(h){if(f.hasActiveDialog)return!1;const y=h.target;if(Ce(h)&&h.key==="a"&&y.tagName!=="INPUT")return r.unselectAllTorrents(),r.selectTorrents(...D.value.map(l=>l.hash)),h.preventDefault(),!0;if(Ce(h)&&h.key==="f"){const l=document.getElementById("searchInput");if(document.activeElement!==l)return Y(!0),h.preventDefault(),!0}if(h.key==="Escape"){const l=document.getElementById("searchInput");return document.activeElement===l||b.value?Y(!1):(g.value=!1,r.unselectAllTorrents()),h.preventDefault(),!0}if(h.key==="Delete")return _.value.length===0?void 0:(f.createDialog(at,{hashes:_.value}),h.preventDefault(),!0);if(h.key==="/"){const l=document.getElementById("searchInput");return document.activeElement!==l&&!b.value&&(o.push({name:"searchEngine"}),h.preventDefault()),!0}}ve(async()=>{await u.fetchCategories(),await u.fetchTags(),Y(ge.value)}),Je(()=>{document.addEventListener("keydown",X),g.value=!1,Q()}),it(()=>{document.removeEventListener("keydown",X)});const ue=E();function $e(h,y){ue.value=setTimeout(()=>{de(h,y)},500)}function ee(){clearTimeout(ue.value)}return(h,y)=>(d(),S(Z,null,[m("div",Ta,[t(Ie,{class:"ma-0 pa-0 mb-2"},{default:a(()=>[t(He,null,{default:a(()=>[we(t(G,{color:"transparent"},{default:a(()=>[t(j,{id:"searchInput",modelValue:V.value,"onUpdate:modelValue":y[0]||(y[0]=l=>V.value=l),label:s(e)("dashboard.searchInputLabel"),clearable:"",density:"compact","hide-details":"","prepend-inner-icon":"mdi-magnify",rounded:"pill","single-line":"",style:{width:"200px"},variant:"solo","onClick:clear":y[1]||(y[1]=l=>Te())},null,8,["modelValue","label"])]),_:1},512),[[xe,b.value]])]),_:1}),t(z,{text:s(e)("dashboard.toggleSearchFilter"),location:"top"},{activator:a(({props:l})=>[t(A,F({icon:b.value?"mdi-chevron-left-circle":"mdi-text-box-search"},l,{variant:"plain",onClick:y[2]||(y[2]=P=>Y())}),null,16,["icon"])]),_:1},8,["text"]),t(z,{text:s(e)("dashboard.toggleSelectMode"),location:"top"},{activator:a(({props:l})=>[t(A,F({icon:s(g)?"mdi-checkbox-marked":"mdi-checkbox-blank-outline"},l,{variant:"plain",onClick:Ve}),null,16,["icon"])]),_:1},8,["text"]),t(z,{text:s(e)("dashboard.toggleSortOrder"),location:"top"},{activator:a(({props:l})=>[t(A,F({icon:s(v).reverseOrder?"mdi-arrow-up-thin":"mdi-arrow-down-thin"},l,{variant:"plain",onClick:y[3]||(y[3]=P=>s(v).reverseOrder=!s(v).reverseOrder)}),null,16,["icon"])]),_:1},8,["text"]),m("div",Va,[t(bt,{modelValue:s(v).sortBy,"onUpdate:modelValue":y[4]||(y[4]=l=>s(v).sortBy=l),items:s(x),label:s(e)("dashboard.sortLabel"),"auto-select-first":"",density:"compact","hide-details":"",variant:"solo-filled"},null,8,["modelValue","items","label"])]),t(ce,{class:"align-center justify-center"},{default:a(()=>[m("span",$a,c(s(k)),1)]),_:1})]),_:1}),t(Ie,{class:"ma-0 pa-0"},{default:a(()=>[t(gt,null,{default:a(()=>[we(t(G,{color:"transparent"},{default:a(()=>[t(z,{text:s(e)("common.selectAll"),location:"bottom"},{activator:a(({props:l})=>[t(A,F({icon:re.value?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",class:"text-grey",color:"transparent",style:{left:"-8px"}},l,{onClick:ie}),null,16,["icon"])]),_:1},8,["text"]),m("span",wa,c(s(e)("dashboard.selectAll")),1)]),_:1},512),[[xe,s(g)]])]),_:1})]),_:1}),s(D).length===0?(d(),S("div",xa,[m("p",Sa,c(s(e)("common.emptyList")),1)])):(d(),S("div",Ba,[t(Ee,{id:"torrentList",class:"pa-0",color:"transparent"},{default:a(()=>[s(w).isPaginationOnTop&&!s(w).isInfiniteScrollActive?(d(),B(te,{key:0},{default:a(()=>[t(ze,{modelValue:s(K),"onUpdate:modelValue":y[5]||(y[5]=l=>ae(K)?K.value=l:null),length:s(se),"next-icon":"mdi-menu-right","prev-icon":"mdi-menu-left",onInput:Q},null,8,["modelValue","length"])]),_:1})):H("",!0),(d(!0),S(Z,null,oe(s(O),l=>(d(),B(te,{id:`torrent-${l.hash}`,class:je([s(i).mobile?"mb-2":"mb-4","pa-0"]),onContextmenu:P=>de(P,l),onTouchcancel:ee,onTouchend:ee,onTouchmove:ee,onTouchstart:P=>$e(P,l),onDblclick:q(P=>ke(l.hash),["prevent"])},{default:a(()=>[m("div",Da,[t(He,null,{default:a(()=>[we(t(G,{class:"mr-3",color:"transparent"},{default:a(()=>[t(A,{icon:s(r).isTorrentInSelection(l.hash)?"mdi-checkbox-marked":"mdi-checkbox-blank-outline",color:"transparent",variant:"flat",onClick:P=>ye(l.hash)},null,8,["icon","onClick"])]),_:2},1536),[[xe,s(g)]])]),_:2},1024),t(ia,{torrent:l},null,8,["torrent"])])]),_:2},1032,["id","class","onContextmenu","onTouchstart","onDblclick"]))),256)),!s(w).isPaginationOnTop&&!s(w).isInfiniteScrollActive?(d(),B(te,{key:1},{default:a(()=>[t(ze,{modelValue:s(K),"onUpdate:modelValue":y[6]||(y[6]=l=>ae(K)?K.value=l:null),length:s(se),"next-icon":"mdi-menu-right","prev-icon":"mdi-menu-left",onInput:Q},null,8,["modelValue","length"])]),_:1})):H("",!0)]),_:1})]))]),m("div",{style:dt(`position: absolute; left: ${p.offset[0]}px; top: ${p.offset[1]}px;`)},[t(ka,{modelValue:p.isVisible,"onUpdate:modelValue":y[7]||(y[7]=l=>p.isVisible=l)},null,8,["modelValue"])],4)],64))}});export{Ra as default};
