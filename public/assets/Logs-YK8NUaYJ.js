import{u as q}from"./ArrayPagination-YZF9XBMt.js";import{aB as z,y as K,aC as l,ay as H,ak as Q,q as S,c as Z,r as f,k as J,d as m,a3 as X,s as Y,a5 as c,i as ee,P as x,aD as te,aE as ae,aF as le,az as se,a as ne,aA as oe,aG as ue,_ as ie}from"./index-HZft94oT.js";import{g as re,$ as de,K as me,d as I,c as g,N as ce,I as pe,a2 as i,a7 as N,m as e,a4 as t,ab as F,Z as r,u as n,a3 as v,D as b,a9 as y,F as B,a8 as fe,a6 as ge,W as V}from"./vue-XHfgLFXq.js";import{d as ve}from"./dayjs.min-bb5lKVNH.js";import"./vuetify-9K5dQHv0.js";const ye={class:"pa-3"},Ve={style:{"font-size":"1.6em !important"},class:"subtitle-1 ml-2"},Le={class:"d-flex justify-end"},_e=re({__name:"Logs",setup(he){const E=de(),{t:P}=me(),L=z(),O=K(),_=I([{title:l[l.NORMAL],value:l.NORMAL},{title:l[l.INFO],value:l.INFO},{title:l[l.WARNING],value:l.WARNING},{title:l[l.CRITICAL],value:l.CRITICAL}]),u=I([l.NORMAL,l.INFO,l.WARNING,l.CRITICAL]),h=I(""),w=g(()=>L.logs),$=g(()=>w.value.filter(a=>u.value.includes(a.type))),{results:T}=H($,h,a=>a.message),C=g(()=>u.value.length>0),k=g(()=>u.value.length===_.value.length),{paginatedResults:U,currentPage:d,pageCount:p}=q(T,30),A=()=>{E.push({name:"dashboard"})},D=a=>`logtype-${l[a?.type]?.toLowerCase()}`,G=a=>l[a.type],M=a=>ve(a.timestamp*1e3).format(O.dateFormat),W=()=>{k.value?u.value=[]:u.value=_.value.map(a=>a.value)},R=a=>{a.key==="Escape"&&A()};return ce(async()=>{document.addEventListener("keydown",R),await L.cleanAndFetchLogs(),Q(L.fetchLogs,15e3)}),pe(()=>{document.removeEventListener("keydown",R)}),(a,o)=>(i(),N("div",ye,[e(S,{"no-gutters":"",align:"center",justify:"center"},{default:t(()=>[e(f,null,{default:t(()=>[F("h1",Ve,r(n(P)("logs.title")),1)]),_:1}),e(f,null,{default:t(()=>[F("div",Le,[e(J,{icon:"mdi-close",variant:"plain",onClick:A})])]),_:1})]),_:1}),e(Z,null,{default:t(()=>[e(m,null,{default:t(()=>[e(S,null,{default:t(()=>[e(f,{cols:"6"},{default:t(()=>[e(X,{modelValue:u.value,"onUpdate:modelValue":o[0]||(o[0]=s=>u.value=s),items:_.value,label:a.$t("logs.filters.type"),"hide-details":"",multiple:"",chips:""},{"prepend-item":t(()=>[e(m,{title:a.$t("common.selectAll"),onClick:W},{prepend:t(()=>[e(Y,{indeterminate:C.value&&!k.value,"model-value":C.value},null,8,["indeterminate","model-value"])]),_:1},8,["title"]),e(c)]),_:1},8,["modelValue","items","label"])]),_:1}),e(f,{cols:"6"},{default:t(()=>[e(ee,{modelValue:h.value,"onUpdate:modelValue":o[1]||(o[1]=s=>h.value=s),label:a.$t("logs.filters.query"),"hide-details":""},null,8,["modelValue","label"])]),_:1})]),_:1})]),_:1}),e(c,{class:"my-3",thickness:"5"}),n(p)>1?(i(),v(m,{key:0},{default:t(()=>[e(x,{modelValue:n(d),"onUpdate:modelValue":o[2]||(o[2]=s=>b(d)?d.value=s:null),length:n(p),"prev-icon":"mdi-menu-left","next-icon":"mdi-menu-right"},null,8,["modelValue","length"])]),_:1})):y("",!0),e(c),(i(!0),N(B,null,fe(n(U),(s,j)=>(i(),N(B,null,[j>0?(i(),v(c,{key:0})):y("",!0),e(m,{class:ge([D(s),"pa-0"])},{default:t(()=>[e(te,{class:"p-0"},{default:t(()=>[e(ae,{class:"pa-0"},{default:t(()=>[e(le,null,{default:t(()=>[e(se,null,{default:t(()=>[V("["+r(s.id)+"] "+r(s.message),1)]),_:2},1024),e(ne),e(oe,null,{default:t(()=>[V(r(G(s))+" | "+r(M(s)),1)]),_:2},1024)]),_:2},1024),e(ue,null,{default:t(()=>[V(r(s.message),1)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1032,["class"])],64))),256)),n(T).length===0?(i(),v(m,{key:1},{default:t(()=>[V(r(a.$t("logs.emptyLogList")),1)]),_:1})):y("",!0),e(c),n(p)>1?(i(),v(m,{key:2},{default:t(()=>[e(x,{modelValue:n(d),"onUpdate:modelValue":o[3]||(o[3]=s=>b(d)?d.value=s:null),length:n(p),"prev-icon":"mdi-menu-left","next-icon":"mdi-menu-right"},null,8,["modelValue","length"])]),_:1})):y("",!0)]),_:1})]))}}),Ae=ie(_e,[["__scopeId","data-v-a1566fdc"]]);export{Ae as default};
